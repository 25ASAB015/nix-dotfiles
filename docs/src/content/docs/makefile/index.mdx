---
title: Makefile - Documentaci√≥n Modular
description: Gu√≠a completa del Makefile modular de Hydenix organizada por categor√≠as
---

import { Card, CardGrid, LinkCard, Aside, Badge, Steps, Tabs, TabItem } from '@astrojs/starlight/components';

# Makefile: Documentaci√≥n Modular

El Makefile de Hydenix centraliza todos los comandos para construir, validar, actualizar, mantener y depurar la configuraci√≥n de NixOS. Esta documentaci√≥n est√° organizada en m√≥dulos que coinciden con la estructura del c√≥digo en `make/*.mk`.

<Aside type="tip" title="Inicio R√°pido">
Si es tu primera vez, comienza con estos comandos esenciales:
```bash
make help            # Lista todos los comandos disponibles
make help-aliases    # Muestra comandos antiguos vs nuevos
make help-examples   # Ejemplos de uso con par√°metros
make sys-test        # Prueba sin aplicar permanentemente
make sys-apply       # Aplica cambios
```
</Aside>

## üìÇ Estructura Modular

El Makefile est√° organizado en m√≥dulos activos que coinciden con las categor√≠as de comandos:

<CardGrid>
  <Card title="üìö docs.mk" icon="document">
    Ayuda y Documentaci√≥n
  </Card>
  <Card title="üîß system.mk" icon="setting">
    Gesti√≥n del Sistema
  </Card>
  <Card title="üßπ cleanup.mk" icon="approve-check">
    Limpieza y Optimizaci√≥n
  </Card>
  <Card title="üì¶ updates.mk" icon="rocket">
    Actualizaciones y Flakes
  </Card>
  <Card title="üíæ generations.mk" icon="list-format">
    Generaciones y Rollback
  </Card>
  <Card title="üîÑ git.mk" icon="github">
    Git y Respaldo
  </Card>
  <Card title="üìã logs.mk" icon="information">
    Diagn√≥stico y Logs
  </Card>
  <Card title="üîç dev.mk" icon="magnifier">
    An√°lisis y Desarrollo
  </Card>
  <Card title="‚ú® format.mk" icon="star">
    Formato y Linting
  </Card>
</CardGrid>

## üìö M√≥dulos de Documentaci√≥n

<CardGrid>
<LinkCard
  title="Ayuda y Documentaci√≥n"
  description="Obtener ayuda y gestionar la web de docs"
  href="./01-docs"
/>

<LinkCard
  title="Gesti√≥n del Sistema"
  description="Compilar, aplicar y validar configuraciones"
  href="./02-system"
/>

<LinkCard
  title="Limpieza y Optimizaci√≥n"
  description="Limpiar generaciones y optimizar el store"
  href="./03-cleanup"
/>

<LinkCard
  title="Actualizaciones y Flakes"
  description="Actualizar inputs y gestionar dependencias"
  href="./04-updates"
/>

<LinkCard
  title="Generaciones y Rollback"
  description="Gestionar versiones del sistema y revertir"
  href="./05-generations"
/>

<LinkCard
  title="Git y Respaldo"
  description="Gestionar el repositorio y sincronizaci√≥n"
  href="./06-git"
/>

<LinkCard
  title="Diagn√≥stico y Logs"
  description="Salud del sistema y visualizaci√≥n de logs"
  href="./07-logs"
/>

<LinkCard
  title="An√°lisis y Desarrollo"
  description="B√∫squeda de paquetes y herramientas dev"
  href="./08-dev"
/>

<LinkCard
  title="Formato y Linting"
  description="Formatear y validar calidad del c√≥digo code"
  href="./09-format"
/>

<LinkCard
  title="Compatibilidad (Aliases)"
  description="Gu√≠a de comandos antiguos y legacy"
  href="./10-aliases"
/>
</CardGrid>

## üîÑ Workflows Recomendados

<Tabs>
  <TabItem label="Flujo Pro">
    <Steps>
    1. **Formatear** archivos Nix
       ```bash
       make fmt-check
       ```
    
    2. **Validar** sintaxis y evaluaci√≥n
       ```bash
       make sys-check
       ```
    
    3. **Aplicar configuraci√≥n** permanentemente
       ```bash
       make sys-apply
       ```
    </Steps>
  </TabItem>

  <TabItem label="Flujo Recuperaci√≥n">
    <Steps>
    1. **Listar** generaciones disponibles
       ```bash
       make gen-list
       ```

    2. **Revertir** a la generaci√≥n anterior (r√°pido)
       ```bash
       make gen-rollback
       ```

    3. **O revertir** a commit espec√≠fico (completo)
       ```bash
       make gen-rollback-commit COMMIT=9220122
       ```
    </Steps>
  </TabItem>

  <TabItem label="Updates Seguros">
    <Steps>
    1. **Actualizar** inputs del flake
       ```bash
       make upd-all
       ```
    
    2. **Ver cambios** en versiones
       ```bash
       make upd-diff
       ```
    
    3. **Validar** configuraci√≥n
       ```bash
       make sys-check
       ```
    
    4. **Aplicar** cambios de forma segura
       ```bash
       make sys-apply-safe
       ```
    </Steps>
  </TabItem>

  <TabItem label="Mantenimiento">
    <Steps>
    1. **Verificar salud** del sistema
       ```bash
       make sys-status
       ```
    
    2. **Limpiar** generaciones antiguas
       ```bash
       make sys-gc
       ```
    
    3. **Optimizar** nix store
       ```bash
       make sys-optimize
       ```
    
    4. **Revisar** tama√±os de generaciones
       ```bash
       make gen-sizes
       ```
    </Steps>
  </TabItem>

  <TabItem label="Multi-host">
    <Steps>
    1. **Listar** hosts disponibles
       ```bash
       make dev-hosts
       ```
    
    2. **Aplicar** configuraci√≥n a un host espec√≠fico
       ```bash
       make sys-apply HOSTNAME=laptop
       ```
    </Steps>
  </TabItem>
</Tabs>

## üí° Sistema de Ayuda

<CardGrid stagger>
  <Card title="make help" icon="open-book">
    Lista completa de comandos modernos con descripciones categorizadas
  </Card>
  <Card title="make help-examples" icon="document">
    Ejemplos de uso para comandos que requieren par√°metros
  </Card>
  <Card title="make help-aliases" icon="list-format">
    [Equivalencias](../10-aliases) para usuarios acostumbrados a comandos cl√°sicos
  </Card>
</CardGrid>

## üéØ Filosof√≠a

<Aside type="note">
El Makefile de Hydenix est√° dise√±ado con estos principios en mente:
</Aside>

- **Nomenclatura Predictiva** - Prefijos claros (`sys-`, `upd-`, `gen-`, `git-`, `log-`, `dev-`, `fmt-`, `doc-`)
- **Documentaci√≥n Centralizada** - Cada m√≥dulo `.mk` tiene su contraparte `.mdx`
- **Compatibilidad Extrema** - Todos los comandos antiguos funcionan como aliases centralizados
- **Workflows Optimizados** - Secuencias predefinidas para tareas cr√≠ticas

<Aside type="caution" title="Importante">
Los comandos cl√°sicos (ej: `make switch`, `make clean`) siguen funcionando pero ya no son los recomendados. Se recomienda la transici√≥n a los nuevos est√°ndares con prefijo.
</Aside>
