---
title: Makefile (Redirigido)
description: DocumentaciÃ³n del Makefile - ahora modularizada
---

# Makefile: DocumentaciÃ³n Modular

La documentaciÃ³n del Makefile ha sido modularizada para facilitar la navegaciÃ³n y el mantenimiento.

**ğŸ‘‰ [Ver documentaciÃ³n completa del Makefile](/nix-dotfiles/makefile/)**

## MÃ³dulos Disponibles

- [Overview](/nix-dotfiles/makefile/) - IntroducciÃ³n y navegaciÃ³n
- [Ayuda y DocumentaciÃ³n](/nix-dotfiles/makefile/01-docs/) - help, help-examples, docs-*
- [GestiÃ³n del Sistema](/nix-dotfiles/makefile/02-system/) - switch, test, build, validate
- [Limpieza y OptimizaciÃ³n](/nix-dotfiles/makefile/03-cleanup/) - clean, optimize
- [Actualizaciones y Flakes](/nix-dotfiles/makefile/04-updates/) - update, upgrade
- [Generaciones y Rollback](/nix-dotfiles/makefile/05-generations/) - list-generations, rollback
- [Git y Respaldo](/nix-dotfiles/makefile/06-git/) - git-*, sync
- [DiagnÃ³stico y Logs](/nix-dotfiles/makefile/07-logs/) - health, test-network, logs-*
- [AnÃ¡lisis y Desarrollo](/nix-dotfiles/makefile/08-dev/) - search, repl, vm
- [Formato y Linting](/nix-dotfiles/makefile/09-format/) - format, lint, tree
- [Reportes](/nix-dotfiles/makefile/10-reports/) - Placeholder
- [Templates](/nix-dotfiles/makefile/11-templates/) - Placeholder

## Estructura Modular

La documentaciÃ³n ahora estÃ¡ organizada en mÃ³dulos que coinciden con la estructura del cÃ³digo en `make/*.mk`:

```
make/
â”œâ”€â”€ docs.mk          # Ayuda y DocumentaciÃ³n
â”œâ”€â”€ system.mk        # GestiÃ³n del Sistema
â”œâ”€â”€ cleanup.mk       # Limpieza y OptimizaciÃ³n
â”œâ”€â”€ updates.mk       # Actualizaciones y Flakes
â”œâ”€â”€ generations.mk   # Generaciones y Rollback
â”œâ”€â”€ git.mk           # Git y Respaldo
â”œâ”€â”€ logs.mk          # DiagnÃ³stico y Logs
â”œâ”€â”€ dev.mk           # AnÃ¡lisis y Desarrollo
â”œâ”€â”€ format.mk        # Formato y Linting
â”œâ”€â”€ reports.mk       # Reportes
â””â”€â”€ templates.mk     # Templates
```

## Ventajas de la ModularizaciÃ³n

- âœ… **NavegaciÃ³n mejorada** - Sidebar organizado por categorÃ­as
- âœ… **SincronizaciÃ³n** - CÃ³digo y documentaciÃ³n con la misma estructura
- âœ… **Mantenimiento** - MÃ¡s fÃ¡cil actualizar documentaciÃ³n especÃ­fica
- âœ… **Escalabilidad** - Agregar nuevos mÃ³dulos es simple

## Inicio RÃ¡pido

```bash
make help            # Lista todos los comandos
make help-examples   # Ejemplos de uso
make test            # Prueba sin aplicar
make switch          # Aplica cambios
```


El Makefile es la puerta de entrada a nuestros dotfiles. Centraliza todos los comandos que usamos para construir, validar, actualizar, mantener y depurar la configuraciÃ³n. Este manual explica **todos y cada uno** de esos comandos para que el proyecto sea sostenible.

Este documento **preserva Ã­ntegramente** el contenido del tutorial original y lo amplÃ­a con contexto adicional para la documentaciÃ³n web. Si algo cambia en el Makefile, este manual debe actualizarse tambiÃ©n.

## Uso rÃ¡pido (referencia inmediata)

```bash
make help            # lista todos los comandos
make help-examples   # ejemplos de uso con parÃ¡metros
make help            # workflows completos
make test            # prueba sin aplicar permanentemente
make switch          # aplica cambios
make rollback        # revierte a la generaciÃ³n anterior
```

## Contexto y filosofÃ­a

- El Makefile elimina comandos largos de NixOS y evita errores tipogrÃ¡ficos.
- Cada target tiene una descripciÃ³n corta para `make help`.
- Los workflows estÃ¡n documentados para que cualquier persona pueda ejecutar tareas crÃ­ticas con seguridad.
- La documentaciÃ³n es parte del producto: si agregas un comando, agrega su explicaciÃ³n aquÃ­.

## NavegaciÃ³n rÃ¡pida

- [Ãndice principal](#indice-principal)
- [Sistema de ayuda](#sistema-ayuda)
- [Comandos por categorÃ­a](#comandos-por-categoria)
- [Flujos de trabajo](#flujos-trabajo)
- [ResoluciÃ³n de problemas](#resolucion-problemas)
- [Tips y trucos](#tips-trucos)
- [Resumen de comandos](#resumen-comandos)
- [Nuevos flujos de trabajo](#nuevos-flujos)
- [Sistema de ayuda hÃ­brido](#sistema-ayuda-hibrido)

---

# ğŸ“š Tutorial Completo de Makefile para NixOS

**GuÃ­a de Usuario - Tu manual esencial para gestionar Hydenix**

---

<a id="indice-principal"></a>
## ğŸ“– Ãndice

1. [Â¿QuÃ© es un Makefile?](#quÃ©-es-un-makefile)
2. [Conceptos BÃ¡sicos](#conceptos-bÃ¡sicos)
3. [Estructura del Makefile de Hydenix](#estructura-del-makefile-de-hydenix)
4. [Comandos por CategorÃ­a](#comandos-por-categorÃ­a)
5. [Flujos de Trabajo Comunes](#flujos-de-trabajo-comunes)
6. [ResoluciÃ³n de Problemas](#resoluciÃ³n-de-problemas)
7. [Tips y Trucos](#tips-y-trucos)

---

## Â¿QuÃ© es un Makefile?

Un **Makefile** es un archivo que contiene un conjunto de instrucciones (llamadas "reglas" o "targets") que automatizan tareas repetitivas. Originalmente diseÃ±ado para compilar programas, se usa ampliamente para cualquier flujo de trabajo que requiera automatizaciÃ³n.

### Â¿Por quÃ© usar un Makefile en NixOS?

Los comandos de NixOS pueden ser largos y difÃ­ciles de recordar:

```bash
# Sin Makefile (tedioso)
sudo nixos-rebuild switch --flake .#hydenix --show-trace --verbose

# Con Makefile (simple)
make debug
```

**Ventajas:**
- âœ… Comandos cortos y memorables
- âœ… Menos errores tipogrÃ¡ficos
- âœ… Consistencia en el equipo
- âœ… DocumentaciÃ³n integrada
- âœ… AutomatizaciÃ³n de tareas complejas

---

## Conceptos BÃ¡sicos

### Sintaxis Fundamental

```makefile
target: dependencias ## DescripciÃ³n (se muestra en help)
	@comando1
	@comando2
```

**Componentes:**
- **target**: nombre del comando (ejemplo: `switch`, `test`)
- **dependencias**: otros targets que deben ejecutarse primero (opcional)
- **@**: suprime el echo del comando (sin @ verÃ­as el comando antes del resultado)
- **##**: comentario especial que aparece en `make help`

### Variables en tu Makefile

```makefile
FLAKE_DIR := .              # Directorio actual (donde estÃ¡ flake.nix)
HOSTNAME := hydenix         # Nombre de tu mÃ¡quina
```

Estas variables se usan con `$(VARIABLE)`:
```makefile
sudo nixos-rebuild switch --flake $(FLAKE_DIR)#$(HOSTNAME)
# Se expande a: sudo nixos-rebuild switch --flake .#hydenix
```

### Colores en el Output

```makefile
RED := \033[0;31m
GREEN := \033[0;32m
YELLOW := \033[0;33m
BLUE := \033[0;34m
PURPLE := \033[0;35m
CYAN := \033[0;36m
NC := \033[0m # No Color
```

Uso: `@printf "$(GREEN)âœ… Ã‰xito\n$(NC)"`

---

## Estructura del Makefile de Hydenix

### 1. Declaraciones Iniciales

```makefile
.PHONY: help switch test ...
.DEFAULT_GOAL := help
```

- `.PHONY`: indica que estos targets no son archivos reales
- `.DEFAULT_GOAL`: si ejecutas solo `make`, corre este target (help)

### 2. CategorÃ­as de Comandos

En el **Makefile actual**, los comandos estÃ¡n agrupados asÃ­:

1. **Ayuda y DocumentaciÃ³n** - Ayuda y lectura de docs
2. **GestiÃ³n del Sistema (Rebuild/Switch)** - Builds y activaciÃ³n
3. **Limpieza y OptimizaciÃ³n** - Limpiezas y optimizaciones
4. **Actualizaciones y Flakes** - Updates y flake tooling
5. **Generaciones y Rollback** - Generaciones y rollback
6. **Git y Respaldo** - Git
7. **DiagnÃ³stico y Logs** - Salud, red y logs
8. **AnÃ¡lisis y Desarrollo** - BÃºsqueda, analysis, VM, repl
9. **Formato, Linting y Estructura** - Format, lint, tree
10. **Reportes y ExportaciÃ³n** - Reportes y exportaciones
11. **Plantillas y Otros** - Templates y utilitarios de hardware/permisos

En esta guÃ­a, el detalle se organiza por bloques funcionales para facilitar la lectura, pero mantiene la **misma cobertura de comandos**.

---

<a id="sistema-ayuda"></a>
## ğŸ“š Sistema de Ayuda en Tres Niveles

Tu Makefile tiene un **sistema de ayuda hÃ­brido** con tres niveles para diferentes necesidades:

### Nivel 1: `make help` - Referencia RÃ¡pida
**Â¿QuÃ© comandos existen?**
- Lista completa de 69 comandos
- DescripciÃ³n de una lÃ­nea
- Para escaneo rÃ¡pido

```bash
make help
```

### Nivel 2: `make help-examples` - Ejemplos PrÃ¡cticos â­ NUEVO
**Â¿CÃ³mo uso este comando?**
- Comandos con ejemplos concretos
- Sintaxis con parÃ¡metros
- MÃºltiples ejemplos por comando
- Para aprender la sintaxis correcta

```bash
make help-examples
```

### Nivel 3: `make help` - Workflows Completos
**Â¿CÃ³mo combino comandos?**
- Workflows para casos de uso comunes
- Secuencias de comandos
- Mejores prÃ¡cticas
- Para flujos de trabajo profesionales

```bash
make help
```

### ğŸ’¡ RecomendaciÃ³n de Uso

```bash
# Â¿Olvidaste quÃ© comandos hay?
make help

# Â¿No sabes cÃ³mo usar un comando con parÃ¡metros?
make help-examples

# Â¿Quieres aprender workflows profesionales?
make help

# Â¿Necesitas documentaciÃ³n completa?
# Visita la documentaciÃ³n web con: make docs-dev
```

---

<a id="comandos-por-categoria"></a>
## Comandos por CategorÃ­a

**Mini Ã­ndice de categorÃ­as:**
- [Building and Switching](#cmd-building-switching)
- [ValidaciÃ³n](#cmd-validation)
- [Multi-Host](#cmd-multi-host)
- [Debugging](#cmd-debugging)
- [Maintenance and Cleanup](#cmd-maintenance)
- [Updates](#cmd-updates)
- [Git Integration](#cmd-git)
- [System Information](#cmd-system-info)
- [BÃºsqueda](#cmd-search)
- [Quick Actions](#cmd-quick-actions)
- [Hardware](#cmd-hardware)
- [Monitoring](#cmd-monitoring)
- [Advanced](#cmd-advanced)
- [Export/Import](#cmd-export)
- [DocumentaciÃ³n](#cmd-docs)
- [Templates](#cmd-templates)
- [Diff Tools](#cmd-diff-tools)
- [Build Analysis](#cmd-build-analysis)
- [Quick Fixes](#cmd-quick-fixes)
- [Utilidades](#cmd-utilities)
<a id="cmd-building-switching"></a>
### ğŸ”¨ Building and Switching

Estos son los comandos que usarÃ¡s **mÃ¡s frecuentemente**.

#### `make help`
Muestra todos los comandos disponibles con descripciones.

```bash
make help
# o simplemente:
make
```

**QuÃ© muestra:**
- Lista completa de 69 comandos
- DescripciÃ³n breve de cada uno
- Organizado por secciÃ³n
- Vista rÃ¡pida de referencia

**CuÃ¡ndo usarlo:** Referencia rÃ¡pida para ver quÃ© comandos existen.

---

#### `make help-examples` â­ NUEVO
Muestra comandos con ejemplos de uso, especialmente Ãºtil para comandos que requieren parÃ¡metros.

```bash
make help-examples
```

**QuÃ© muestra:**
```
â•â•â• ğŸ” Search & Discovery â•â•â•
search PKG=<name>
  â†’ make search PKG=firefox
  â†’ make search PKG=neovim

search-installed PKG=<name>
  â†’ make search-installed PKG=kitty

â•â•â• ğŸ“¦ Updates â•â•â•
update-input INPUT=<name>
  â†’ make update-input INPUT=hydenix
  â†’ make update-input INPUT=nixpkgs

```

**Perfecto para:**
- Comandos que requieren parÃ¡metros (PKG, INPUT, HOST, etc)
- Ver ejemplos concretos de uso
- Aprender la sintaxis correcta
- Nuevos usuarios del sistema

**CuÃ¡ndo usarlo:** Cuando necesitas saber **cÃ³mo usar** un comando especÃ­fico.

---

#### `make help`
Muestra ayuda avanzada con workflows completos y ejemplos.

```bash
make help
# GuÃ­a de workflows: desarrollo diario, updates seguros, mantenimiento, etc
```

---

#### `make switch`
**â­ Comando mÃ¡s usado** - Compila y activa tu nueva configuraciÃ³n.

```bash
make switch
```

**QuÃ© hace:**
1. `git add .` - Staging de todos los cambios
2. Compila la configuraciÃ³n
3. Activa la nueva configuraciÃ³n (disponible inmediatamente)
4. Crea una nueva generaciÃ³n del sistema

**CuÃ¡ndo usarlo:**
- DespuÃ©s de editar `flake.nix`, mÃ³dulos, o cualquier configuraciÃ³n
- Cuando quieres aplicar cambios ahora mismo
- Flujo normal de trabajo

**Ejemplo de flujo:**
```bash
# 1. Editas un archivo
nvim modules/hm/programs/terminal/kitty.nix

# 2. Aplicas cambios
make switch

# 3. Si algo falla, revierte
make rollback
```

---

#### `make test`
Prueba tu configuraciÃ³n compilÃ¡ndola y activÃ¡ndola temporalmente sin crear una generaciÃ³n permanente.

```bash
make test
```

**QuÃ© hace:**
- âœ… Compila la configuraciÃ³n completa
- âœ… Activa la configuraciÃ³n **TEMPORALMENTE** en tu sesiÃ³n actual
- âš ï¸ Los cambios se **PIERDEN al reiniciar** el sistema
- âŒ **NO crea** una nueva generaciÃ³n permanente

**Â¿Por quÃ© es Ãºtil?**
- **Testing seguro:** Permite probar configuraciones experimentales sin riesgo
- **Sin rollback necesario:** Si algo falla, simplemente reinicias y vuelves a la normalidad
- **Sin generaciones:** Puedes probar mÃºltiples cambios sin llenar de generaciones el sistema
- **VerificaciÃ³n rÃ¡pida:** Comprueba que compila y funciona antes de hacer permanente

**CuÃ¡ndo usarlo:**
- Probar configuraciones experimentales sin riesgo
- Verificar que compila antes de commitear cambios importantes
- Testing de cambios grandes antes de hacerlos permanentes
- Experimentar con nuevas configuraciones sin consecuencias
- Probar mÃºltiples variaciones de configuraciÃ³n

**ComparaciÃ³n con otros comandos:**

| Comando | Compila | Activa | Persiste | GeneraciÃ³n |
|---------|---------|--------|----------|------------|
| `make build` | âœ… | âŒ | N/A | âŒ |
| `make test` | âœ… | âœ… | Solo sesiÃ³n | âŒ |
| `make switch` | âœ… | âœ… | Permanente | âœ… |
| `make boot` | âœ… | âœ… | PrÃ³ximo boot | âœ… |

**Flujo recomendado (rÃ¡pido y seguro):**
```bash
# 1. Probar primero (seguro, temporal)
make test

# 2. Si funciona bien, hacer permanente
make switch

# 3. Si algo falla, simplemente reinicia
# Los cambios de 'test' se pierden automÃ¡ticamente
```

**Casos de uso reales:**

**Ejemplo 1: Probar nueva configuraciÃ³n de Hyprland**
```bash
# Editas la configuraciÃ³n
nvim modules/hm/programs/hyprland.nix

# Pruebas sin riesgo
make test

# Si funciona bien:
make switch        # Hace permanente

# Si falla:
# Solo reinicia, los cambios se pierden automÃ¡ticamente
```

**Ejemplo 2: Verificar antes de commit**
```bash
# Haces cambios importantes
nvim flake.nix

# Verificas que compila y funciona
make test

# Ahora puedes commitear con confianza
git commit -m "feat: nueva configuraciÃ³n"
```

**Ejemplo 3: Probar mÃºltiples configuraciones**
```bash
# Prueba configuraciÃ³n A
make test
# Reinicia para volver a la normalidad

# Prueba configuraciÃ³n B
make test
# Reinicia para volver a la normalidad

# Cuando encuentres la mejor configuraciÃ³n:
make switch        # Hace permanente
```

**Ventajas:**
- âœ… Ãšnico comando que activa temporalmente (diferente de `make build`)
- âœ… Permite experimentar sin riesgo
- âœ… No requiere rollback manual si algo falla
- âœ… Parte del flujo de trabajo recomendado
- âœ… No crea generaciones innecesarias

**Nota importante:** A diferencia de `make build` que solo compila sin activar, `make test` compila **Y activa** temporalmente. Esto te permite probar la configuraciÃ³n en un entorno real pero sin consecuencias permanentes.

---

#### `make build`
Compila la configuraciÃ³n sin aplicar cambios al sistema e incluye mediciÃ³n de tiempo.

```bash
make build
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#           ğŸ”¨ Build Configuration                    
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# Building configuration without applying changes...
# This will compile but not activate the new generation.
# 
# [build output...]
# 
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âœ… Build completed successfully
# Configuration compiled but not activated.
# Use 'make switch' to apply changes.
# 
# Build Statistics:
#   Build time: 2m 15s (135s total)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**CuÃ¡ndo usarlo:**
- Verificar que no hay errores de compilaciÃ³n antes de aplicar cambios
- CI/CD pipelines para validar que la configuraciÃ³n compila
- Debugging: ver errores de build sin afectar el sistema
- ValidaciÃ³n: comprobar cambios antes de hacer `make switch`
- Medir performance: ver cuÃ¡nto tiempo tarda el build
- Comparar tiempos: identificar si cambios afectan el tiempo de build

**CaracterÃ­sticas:**
- Mide automÃ¡ticamente el tiempo de build
- Muestra estadÃ­sticas informativas al finalizar
- No aplica cambios al sistema (solo compila)
- Preserva el cÃ³digo de salida del build

**Diferencia con otros comandos:**
- `make test`: Compila y activa temporalmente (se revierte al reiniciar)
- `make switch`: Compila y activa permanentemente
- `make build`: Solo compila, no activa nada, incluye mediciÃ³n de tiempo

---

#### `make clean-result`
Elimina symlinks `result*` que quedan despuÃ©s de builds de Nix.

```bash
make clean-result
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#           ğŸ§¹ Clean Result Symlinks                  
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# Searching for result symlinks...
# These symlinks are created by Nix builds and can be safely removed.
# 
# Found 2 result symlink(s):
#   ./result â†’ /nix/store/...-nixos-system-hydenix-26.05...
#   ./result-vm â†’ /nix/store/...-run-nixos-vm
# 
# Removing symlinks...
# âœ… Removed 2 symlink(s)
# 
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âœ… Cleanup complete
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**QuÃ© hace:**
- Busca symlinks `result*` en el directorio actual y un nivel de profundidad
- Muestra quÃ© symlinks encontrÃ³ y a dÃ³nde apuntan
- Elimina los symlinks de forma segura
- No afecta el store de Nix (solo elimina los symlinks, no los builds)

**CuÃ¡ndo usarlo:**
- DespuÃ©s de builds: limpiar symlinks residuales de `nix build` o `nixos-rebuild build`
- Mantenimiento: mantener el directorio del proyecto limpio
- Antes de commits: evitar incluir symlinks en git (aunque deberÃ­an estar en .gitignore)

**RelaciÃ³n con `make build`:**
- `make build` crea symlinks `result*` que apuntan a los builds
- `make clean-result` elimina estos symlinks despuÃ©s de usarlos
- Ãštil para limpiar despuÃ©s de mÃºltiples builds

**Nota:** Estos symlinks son creados por Nix para facilitar el acceso a builds. Eliminarlos no afecta los builds en el store de Nix, solo limpia el directorio del proyecto.

---

#### `make dry-run`
Muestra quÃ© cambiarÃ­a sin hacer cambios reales usando `nixos-rebuild dry-run`.

```bash
make dry-run
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ” Dry Run - Preview Changes             
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Showing what would be built/changed without applying...

building the system configuration...
[detalles de lo que se construirÃ­a/cambiarÃ­a]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Dry run completed
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Â¿Por quÃ© es necesario?**
- **Seguridad:** Ver exactamente quÃ© cambios se aplicarÃ­an antes de ejecutarlos
- **PlanificaciÃ³n:** Entender el impacto de actualizaciones o cambios de configuraciÃ³n
- **Debugging:** Identificar problemas de dependencias o configuraciones incorrectas antes de aplicar
- **Transparencia:** Saber quÃ© paquetes se construirÃ­an o descargarÃ­an

**CuÃ¡ndo usarlo:**
- Antes de `make switch` en cambios grandes o importantes
- DespuÃ©s de `make update` para ver quÃ© se actualizarÃ­a
- Cuando sospechas que un cambio puede tener efectos inesperados
- Para entender el impacto de agregar o remover paquetes
- Antes de aplicar cambios en producciÃ³n o sistemas crÃ­ticos

**Ventajas:**
- No modifica el sistema, solo muestra quÃ© pasarÃ­a
- RÃ¡pido comparado con un rebuild completo
- Muestra dependencias y paquetes afectados
- Ãštil para estimar tiempo de construcciÃ³n

---

#### `make boot`
Compila la configuraciÃ³n y la prepara para el prÃ³ximo arranque sin afectar la sesiÃ³n actual.

```bash
make boot
```

**QuÃ© hace:**
- âœ… Compila la configuraciÃ³n completa
- âœ… Configura la nueva generaciÃ³n como predeterminada para el prÃ³ximo boot
- âš ï¸ **NO afecta** la sesiÃ³n actual (los cambios se aplican al reiniciar)
- âœ… Crea una nueva generaciÃ³n del sistema

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ¥¾ Configurar para PrÃ³ximo Arranque      
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Compilando y configurando para el prÃ³ximo arranque...
Los cambios se aplicarÃ¡n al reiniciar el sistema.
La sesiÃ³n actual no se verÃ¡ afectada.

[output del build...]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… ConfiguraciÃ³n preparada para prÃ³ximo arranque
Reinicia el sistema para aplicar los cambios.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Â¿Por quÃ© es Ãºtil?**
- **Cambios que requieren reinicio:** Algunas configuraciones solo se aplican al arrancar
- **Sin interrumpir trabajo:** Puedes seguir trabajando y reiniciar cuando sea conveniente
- **Seguridad:** Compila antes de aplicar, detectando errores temprano
- **PlanificaciÃ³n:** Permite preparar cambios para aplicar mÃ¡s tarde

**CuÃ¡ndo usarlo:**
- Cambios en el kernel o bootloader (requieren reinicio obligatorio)
- Configuraciones que requieren reinicio para funcionar correctamente
- Cuando no quieres cerrar sesiÃ³n ahora pero quieres preparar cambios
- Cambios importantes que prefieres aplicar en el prÃ³ximo arranque
- Cuando estÃ¡s trabajando y no puedes interrumpir tu sesiÃ³n

**ComparaciÃ³n con otros comandos:**

| Comando | Afecta sesiÃ³n actual | Requiere reinicio | CuÃ¡ndo aplicar |
|---------|---------------------|-------------------|----------------|
| `make switch` | âœ… SÃ­ (inmediato) | âŒ No | Ahora mismo |
| `make boot` | âŒ No | âœ… SÃ­ | PrÃ³ximo arranque |
| `make test` | âœ… SÃ­ (temporal) | âŒ No | Solo esta sesiÃ³n |

**Casos de uso reales:**

**Ejemplo 1: Cambio de kernel**
```bash
# Editas la configuraciÃ³n del kernel
nvim hosts/hydenix/configuration.nix

# Compilas y preparas para prÃ³ximo boot
make boot

# Puedes seguir trabajando...
# Cuando estÃ©s listo, reinicias y el nuevo kernel se aplicarÃ¡
```

**Ejemplo 2: Cambios en bootloader**
```bash
# Modificas configuraciÃ³n de GRUB
nvim hosts/hydenix/configuration.nix

# Preparas para prÃ³ximo arranque
make boot

# Reinicias cuando sea conveniente
```

**Ejemplo 3: Cambios que requieren reinicio**
```bash
# Cambios en servicios crÃ­ticos que requieren reinicio
make boot

# ContinÃºas trabajando...
# Reinicias al final del dÃ­a
```

**Ventajas:**
- âœ… No interrumpe tu trabajo actual
- âœ… Permite planificar cuÃ¡ndo aplicar cambios
- âœ… Compila antes de aplicar (detecta errores temprano)
- âœ… Ãštil para cambios que requieren reinicio obligatorio

**Nota importante:** DespuÃ©s de `make boot`, debes reiniciar el sistema para que los cambios se apliquen. Si cambias de opiniÃ³n antes de reiniciar, puedes usar `make switch` para aplicar cambios inmediatamente o `make rollback` si necesitas revertir.

---

<a id="cmd-validation"></a>
### âœ… ValidaciÃ³n

#### `make validate`
Valida la configuraciÃ³n antes de aplicarla mediante tres chequeos: sintaxis del flake, evaluaciÃ³n de configuraciÃ³n y problemas comunes.

```bash
make validate
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ” Validation Checks                       
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1/3 Checking flake syntax... âœ“
2/3 Checking configuration evaluation... âœ“
3/3 Checking for common issues... âœ“

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Validation passed
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Â¿Por quÃ© es necesario?**
- **PrevenciÃ³n de errores:** Detecta problemas antes de intentar aplicar la configuraciÃ³n
- **Ahorro de tiempo:** Evita rebuilds que fallarÃ­an por errores de sintaxis o evaluaciÃ³n
- **Calidad del cÃ³digo:** Usa `statix` para detectar problemas comunes en cÃ³digo Nix
- **Confianza:** Te asegura que la configuraciÃ³n es vÃ¡lida antes de hacer `make switch`

**QuÃ© verifica:**
1. **Sintaxis del flake:** Valida que `flake.nix` y sus inputs sean correctos
2. **EvaluaciÃ³n de configuraciÃ³n:** Verifica que la configuraciÃ³n de NixOS se pueda evaluar correctamente
3. **Problemas comunes:** Usa `statix` para detectar anti-patrones y problemas conocidos

**CuÃ¡ndo usarlo:**
- Antes de cada `make switch` para asegurar que la configuraciÃ³n es vÃ¡lida
- DespuÃ©s de editar archivos `.nix` para verificar que no introdujiste errores
- Como parte de un workflow de CI/CD para validar cambios
- Antes de hacer commit de cambios importantes
- Cuando sospechas que hay un error de sintaxis o configuraciÃ³n

**Ventajas:**
- Muy rÃ¡pido comparado con un rebuild completo
- Detecta errores temprano en el proceso
- Proporciona feedback claro sobre quÃ© estÃ¡ mal
- Puede integrarse en scripts automatizados

#### `make safe-switch`
Valida la configuraciÃ³n y luego aplica los cambios de forma segura. Es la opciÃ³n mÃ¡s segura para aplicar cambios importantes.

```bash
make safe-switch
```

**QuÃ© hace:**
1. âœ… Ejecuta `make validate` primero (3 chequeos):
   - **1/3:** Verifica sintaxis del flake (`flake.nix`, `flake.lock`)
   - **2/3:** Verifica evaluaciÃ³n de configuraciÃ³n NixOS
   - **3/3:** Busca problemas comunes con `statix` (si estÃ¡ instalado)

2. âœ… Si `validate` pasa, ejecuta `make switch`:
   - `git add .` - Staging de cambios
   - Compila la configuraciÃ³n
   - Activa permanentemente
   - Crea nueva generaciÃ³n

3. âš ï¸ Si `validate` falla:
   - **NO ejecuta** `switch`
   - Muestra el error especÃ­fico
   - Te ahorra tiempo y problemas

**Â¿Por quÃ© es Ãºtil?**
- **Seguridad automÃ¡tica:** Valida ANTES de aplicar automÃ¡ticamente
- **PrevenciÃ³n de errores:** Detecta problemas antes de compilar
- **Ahorra tiempo:** Evita builds de minutos que fallarÃ­an por errores de sintaxis
- **Conveniencia:** Todo-en-uno (valida + aplica en un comando)
- **Mejores prÃ¡cticas:** EnseÃ±a a validar antes de aplicar

**CuÃ¡ndo usarlo:**
- Cambios importantes o complejos (mÃ³dulos nuevos, mÃºltiples archivos)
- DespuÃ©s de `make update` (cuando hay cambios en `flake.lock`)
- Cuando no estÃ¡s 100% seguro de tus cambios
- Imports nuevos o modificados
- Modificaciones en archivos crÃ­ticos del sistema

**ComparaciÃ³n con otros comandos:**

| Comando | Valida | Compila | Activa | GeneraciÃ³n |
|---------|--------|---------|--------|------------|
| `make validate` | âœ… | âŒ | âŒ | âŒ |
| `make switch` | âŒ | âœ… | âœ… | âœ… |
| `make safe-switch` | âœ… | âœ… | âœ… | âœ… |

**Diferencias con `make switch`:**

**`make switch`:**
- âœ… MÃ¡s rÃ¡pido (sin validaciÃ³n)
- âœ… Para cambios pequeÃ±os y confiables
- âŒ Puede fallar despuÃ©s de compilar
- âŒ Requiere que ejecutes `validate` manualmente

**`make safe-switch`:**
- âœ… MÃ¡s seguro (valida primero)
- âœ… Detecta errores antes de compilar
- âœ… Todo-en-uno (un solo comando)
- âœ… Perfecto para cambios importantes
- âš ï¸ Un poco mÃ¡s lento (ejecuta `validate` primero)

**Casos de uso reales:**

**Ejemplo 1: DespuÃ©s de actualizar flake inputs**
```bash
# Actualizas los inputs del flake
make update

# Valida cambios + aplica de forma segura
make safe-switch
# Si hay incompatibilidades, validate las detecta
# antes de intentar compilar
```

**Ejemplo 2: Agregar nuevo mÃ³dulo completo**
```bash
# Creas un nuevo mÃ³dulo
nvim modules/hm/programs/nuevo-programa.nix

# Agregas el import en flake.nix
nvim flake.nix

# Valida sintaxis + aplica
make safe-switch
# Detecta si el mÃ³dulo tiene errores antes de aplicar
```

**Ejemplo 3: Cambios en mÃºltiples archivos**
```bash
# Editas varios archivos relacionados
nvim flake.nix
nvim hosts/hydenix/configuration.nix
nvim modules/hm/default.nix

# Valida que todos los cambios son compatibles + aplica
make safe-switch
```

**Ejemplo 4: Cuando no estÃ¡s seguro**
```bash
# Hiciste cambios pero no estÃ¡s 100% seguro
make safe-switch
# MÃ¡s seguro que switch directo
# Si hay problemas, validate los detecta primero
```

**Flujos de trabajo:**

**Flujo 1: Desarrollo Iterativo (mÃ¡s rÃ¡pido)**
```bash
make validate    # Validar primero
make switch      # Aplicar si pasa
```

**Flujo 2: Cambios Importantes (mÃ¡s seguro) â­ RECOMENDADO**
```bash
make safe-switch # Todo-en-uno: valida + aplica
```

**Flujo 3: Testing antes de permanente**
```bash
make test        # Probar temporalmente
make safe-switch # Si funciona, hacer permanente
```

**Ventajas:**
- âœ… Seguridad automÃ¡tica sin pasos adicionales
- âœ… Conveniencia: un solo comando en lugar de dos
- âœ… Previene errores antes de aplicar cambios
- âœ… Ahorra tiempo detectando problemas temprano
- âœ… Sigue mejores prÃ¡cticas de desarrollo
- âœ… No aplica si hay errores (fail-safe)

**RecomendaciÃ³n de uso:**
- **`make switch`** â†’ Para cambios pequeÃ±os y frecuentes (desarrollo iterativo)
- **`make safe-switch`** â†’ Para cambios importantes o cuando no estÃ¡s seguro

**Ver tambiÃ©n:** [Flujo de Trabajo Recomendado](#flujo-recomendado) para mÃ¡s detalles sobre cuÃ¡ndo usar cada comando.

#### `make health`
Chequeo rÃ¡pido de salud del sistema que verifica aspectos crÃ­ticos sin operaciones costosas.

```bash
make health
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ¥ System Health Check                    
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Flake validation: âœ“ Passed
2. Disk space (/nix): 47% used (250G free)
3. Generations count: 33 generations
4. Boot entries: 5 entries
5. Failed services: âœ“ None
6. Git status: âœ“ Clean

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Health check complete
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Â¿Por quÃ© es necesario?**
- **Monitoreo preventivo:** Detecta problemas antes de que se vuelvan crÃ­ticos
- **Mantenimiento proactivo:** Identifica cuÃ¡ndo necesitas limpiar espacio o servicios
- **Estado del sistema:** Proporciona una vista rÃ¡pida del estado general
- **Debugging inicial:** Primer paso para diagnosticar problemas del sistema

**QuÃ© verifica:**
1. **Flake validation:** La configuraciÃ³n es vÃ¡lida
2. **Disk space:** Espacio disponible en `/nix` (crÃ­tico para builds)
3. **Generations count:** CuÃ¡ntas generaciones tienes (Ãºtil para limpieza)
4. **Boot entries:** Entradas de arranque disponibles
5. **Failed services:** Servicios systemd que fallaron
6. **Git status:** Estado del repositorio de dotfiles

**CuÃ¡ndo usarlo:**
- Regularmente para monitorear el estado del sistema
- Antes de hacer cambios importantes
- Cuando experimentas problemas inesperados
- Como parte de un mantenimiento rutinario
- DespuÃ©s de actualizaciones o cambios grandes

**Nota importante:**
Este comando estÃ¡ optimizado para ser rÃ¡pido. Eliminamos la verificaciÃ³n del store (`nix-store --verify`) porque puede tardar horas en sistemas grandes. Si necesitas verificar la integridad del store, usa `make fix-store` directamente.

**Ventajas:**
- EjecuciÃ³n rÃ¡pida (segundos, no minutos)
- Proporciona informaciÃ³n Ãºtil sin ser invasivo
- Formato claro y fÃ¡cil de leer
- Identifica problemas comunes rÃ¡pidamente

---

<a id="cmd-multi-host"></a>
### ğŸ–¥ï¸ Multi-Host

#### `make list-hosts`
Lista todas las configuraciones de hosts disponibles con informaciÃ³n detallada.

```bash
make list-hosts
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“‹ Available Hosts                         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Total hosts: 3
Configured: 3

Hosts overview:
  hydenix         âœ“ configured (current)
  laptop          âœ“ configured
  vm              âœ“ configured

Detailed information:

  hydenix (current)
    Status: âœ“ configured
    Path: hosts/hydenix/
    Files: 2

  laptop
    Status: âœ“ configured
    Path: hosts/laptop/
    Files: 3

  vm
    Status: âœ“ configured
    Path: hosts/vm/
    Files: 3

Usage: make switch HOSTNAME=<host>
Example: make switch HOSTNAME=laptop
```

**Usar con otros comandos:**
```bash
make switch HOSTNAME=laptop  # Deploy a laptop
make test HOSTNAME=vm        # Probar config de VM
```

---

<a id="cmd-debugging"></a>
### ğŸ› Debugging

#### `make debug`
Rebuild con output verbose completo y trace de errores.

```bash
make debug
```

**CuÃ¡ndo usarlo:**
- Cuando `make switch` falla
- Errores crÃ­pticos
- Problemas de evaluaciÃ³n de Nix

**Output incluye:**
- Stack traces completos
- Valores de variables
- Camino de evaluaciÃ³n

---

#### `make flake-check`
Valida la sintaxis del flake sin compilar.

```bash
make flake-check
# Equivalente a: nix flake check
```

**CuÃ¡ndo usarlo:**
- VerificaciÃ³n rÃ¡pida de sintaxis
- Antes de commits
- Debugging de errores de parsing

**Output exitoso:**
```
âœ“ checks.x86_64-linux.default
âœ“ nixosConfigurations.hydenix
```

---

#### `make show`
Muestra la estructura completa de salidas (outputs) del flake, incluyendo todas las configuraciones NixOS y paquetes disponibles.

```bash
make show
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“„ Flake Outputs Structure                
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

git+file:///home/ludus/Dotfiles?ref=refs/heads/main&rev=38ee020...
â”œâ”€â”€â”€nixosConfigurations
â”‚   â”œâ”€â”€â”€default: NixOS configuration
â”‚   â””â”€â”€â”€hydenix: NixOS configuration
â””â”€â”€â”€packages
    â””â”€â”€â”€x86_64-linux
        â””â”€â”€â”€vm: package 'nixos-vm'
```

**Â¿Para quÃ© sirve?**

1. **Descubrir hosts disponibles:** Ver todas las configuraciones NixOS definidas en tu flake sin tener que leer `flake.nix` manualmente. Ãštil cuando trabajas con mÃºltiples mÃ¡quinas o cuando olvidas quÃ© hosts estÃ¡n configurados.

2. **Ver paquetes definidos:** Identificar quÃ© paquetes personalizados estÃ¡n disponibles en el flake (como `vm` en el ejemplo, que genera una mÃ¡quina virtual NixOS).

3. **Validar estructura del flake:** Verificar rÃ¡pidamente que el flake estÃ¡ bien estructurado y que todas las salidas esperadas estÃ¡n presentes antes de intentar hacer un `switch` o `build`.

4. **Entender la organizaciÃ³n:** Obtener una vista de alto nivel de cÃ³mo estÃ¡ organizado tu flake, especialmente Ãºtil cuando colaboras con otros o cuando vuelves a un proyecto despuÃ©s de tiempo.

5. **Troubleshooting:** Si un comando como `make switch HOSTNAME=algo` falla, puedes usar `make show` para verificar si ese host realmente existe en el flake.

**RelaciÃ³n con otros comandos:**
- `make list-hosts` - Muestra informaciÃ³n detallada de cada host (usa `make show` internamente)
- `make switch HOSTNAME=<host>` - Requiere que el host exista en `nixosConfigurations` (verificable con `make show`)
- `make flake-check` - Valida la sintaxis, mientras que `make show` valida la estructura

**CuÃ¡ndo usarlo:**
- Antes de hacer un `switch` a un host nuevo para verificar que existe
- Cuando necesitas recordar quÃ© hosts estÃ¡n disponibles
- Para descubrir quÃ© paquetes personalizados puedes usar
- Como verificaciÃ³n rÃ¡pida despuÃ©s de modificar `flake.nix`

---

#### `make test-network`
DiagnÃ³stico completo de red (DNS, ping, throughput y ruta) con formato visual mejorado.

```bash
make test-network
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸŒ Network Diagnostics                    
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. DNS status (resolved):
[estado de DNS]

2. DNS from NetworkManager:
[configuraciÃ³n DNS]

3. Ping (1.1.1.1):
[resultados de ping]

...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Network diagnostics complete
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**QuÃ© hace:**
- Verifica DNS activos (systemd-resolved y NetworkManager)
- Mide latencia a 1.1.1.1 y google.com
- Mide throughput con Cloudflare (50MB, mÃ¡ximo 20s)
- Ejecuta speedtest al servidor mÃ¡s cercano
- Analiza calidad de ruta con mtr (50 probes a 1.1.1.1)

**CaracterÃ­sticas:**
- Formato visual consistente con otros comandos
- Encabezado y footer con lÃ­neas de separaciÃ³n
- Pruebas completas de conectividad y rendimiento
- Manejo de errores cuando herramientas no estÃ¡n disponibles

**CuÃ¡ndo usarlo:**
- NavegaciÃ³n lenta o intermitente
- Verificar rendimiento real del ISP
- Confirmar que el DNS no estÃ¡ siendo inyectado
- Diagnosticar problemas de conectividad
- Medir calidad de conexiÃ³n antes y despuÃ©s de cambios de red

---

<a id="cmd-maintenance"></a>
### ğŸ§¹ Maintenance and Cleanup

Los comandos de limpieza son **esenciales** para mantener tu sistema NixOS funcionando de manera eficiente. NixOS guarda **TODAS** las versiones antiguas de paquetes y configuraciones, lo que permite rollbacks increÃ­blemente Ãºtiles pero consume espacio en disco.

#### Â¿Por quÃ© son importantes estos comandos?

1. **GestiÃ³n de espacio en disco**: NixOS acumula generaciones y paquetes que pueden ocupar decenas o cientos de GB
2. **Rendimiento del sistema**: Un store grande puede ralentizar operaciones de bÃºsqueda y construcciÃ³n
3. **Mantenimiento preventivo**: Limpieza regular previene problemas de espacio antes de que ocurran
4. **OptimizaciÃ³n**: Los comandos de optimizaciÃ³n mejoran el uso del espacio sin perder funcionalidad
5. **Flexibilidad**: Diferentes niveles de limpieza permiten balancear seguridad vs espacio segÃºn necesidades

---

#### `make clean`
Limpieza estÃ¡ndar - elimina generaciones y paquetes de mÃ¡s de 30 dÃ­as.

```bash
make clean
```

**QuÃ© elimina:**
- Generaciones del sistema mayores a 30 dÃ­as
- Generaciones de usuario mayores a 30 dÃ­as
- Paquetes no referenciados por ninguna generaciÃ³n activa
- Build artifacts antiguos

**Espacio liberado tÃ­pico:** 5-20 GB (depende del uso del sistema)

**QuÃ© mantiene:**
- Ãšltimas 30 dÃ­as de generaciones (permite rollback reciente)
- Todos los paquetes referenciados por generaciones activas

**CuÃ¡ndo usarlo:**
- **Rutina mensual**: Como parte del mantenimiento regular del sistema
- **Antes de actualizaciones grandes**: Libera espacio para nuevas construcciones
- **Cuando `/nix/store` estÃ¡ grande**: Verifica con `make info` el tamaÃ±o del store
- **DespuÃ©s de muchas instalaciones**: Limpia paquetes temporales y artefactos

**Flujo recomendado:**
```bash
# Ver estado actual
make info

# Limpiar
make clean

# Verificar espacio liberado
make info

# Opcional: optimizar despuÃ©s de limpiar
make optimize
```

---

#### `make clean-week`
Limpieza mÃ¡s agresiva - mantiene solo Ãºltimos 7 dÃ­as de historial.

```bash
make clean-week
```

**QuÃ© elimina:**
- Generaciones mayores a 7 dÃ­as
- Paquetes no referenciados
- Build artifacts antiguos

**Espacio liberado tÃ­pico:** 10-40 GB (mÃ¡s que `make clean`)

**âš ï¸ Cuidado importante:**
- Solo podrÃ¡s hacer rollback a generaciones de la Ãºltima semana
- Si necesitas volver a una configuraciÃ³n de hace mÃ¡s de 7 dÃ­as, no podrÃ¡s
- Ãštil cuando necesitas espacio rÃ¡pidamente pero mantienes algo de seguridad

**CuÃ¡ndo usarlo:**
- **Poco espacio en disco**: Necesitas liberar espacio rÃ¡pidamente
- **Muchos rebuilds recientes**: Has estado experimentando y tienes muchas generaciones nuevas
- **Testing intensivo**: Has hecho muchas pruebas y las generaciones antiguas no son crÃ­ticas
- **Sistema de desarrollo**: Donde la estabilidad a largo plazo no es crÃ­tica

**Ejemplo de uso:**
```bash
# Verificar espacio antes
make info

# Limpieza semanal
make clean-week

# Verificar espacio liberado
make info
```

---

#### `make clean-conservative`
Limpieza muy segura - mantiene Ãºltimos 90 dÃ­as de historial.

```bash
make clean-conservative
```

**QuÃ© elimina:**
- Solo generaciones y paquetes mayores a 90 dÃ­as
- Mantiene 3 meses completos de historial

**Espacio liberado tÃ­pico:** 2-10 GB (menos que `make clean` pero mÃ¡s seguro)

**Ventajas:**
- MÃ¡xima seguridad para rollback
- Permite volver a configuraciones de hasta 3 meses atrÃ¡s
- Ideal para sistemas donde la estabilidad es crÃ­tica

**CuÃ¡ndo usarlo:**
- **Primera vez que limpias**: Si nunca has limpiado antes, empieza con esto
- **Sistema de producciÃ³n crÃ­tico**: Donde necesitas mÃ¡xima capacidad de rollback
- **Quieres mÃ¡xima seguridad**: Prefieres mantener mÃ¡s historial que liberar espacio
- **DespuÃ©s de cambios importantes**: Cuando quieres mantener un historial largo por seguridad

**RecomendaciÃ³n:** Si no estÃ¡s seguro de quÃ© comando usar, empieza con `make clean-conservative`.

---

#### `make optimize`
Optimiza el Nix store encontrando archivos duplicados y convirtiÃ©ndolos en hardlinks.

```bash
make optimize
```

**QuÃ© hace:**
- Escanea todo el `/nix/store` buscando archivos idÃ©nticos
- Convierte duplicados en hardlinks (mismo archivo, mÃºltiples referencias)
- **No elimina nada** - solo optimiza el uso del espacio
- Proceso completamente seguro y reversible

**Espacio ahorrado tÃ­pico:** 1-5 GB (depende de cuÃ¡ntos paquetes compartan archivos)

**Tiempo de ejecuciÃ³n:** 
- 5-15 minutos en sistemas pequeÃ±os (< 50 GB)
- 15-30 minutos en sistemas medianos (50-150 GB)
- 30-60+ minutos en sistemas grandes (> 150 GB)

**CuÃ¡ndo usarlo:**
- **DespuÃ©s de muchas instalaciones**: Cuando has instalado muchos paquetes nuevos
- **Rutina mensual**: Como parte del mantenimiento regular
- **Complemento de limpieza**: DespuÃ©s de `make clean` para maximizar espacio
- **Antes de hacer backup**: Optimiza antes de respaldar el store

**Ejemplo de flujo completo:**
```bash
# 1. Ver estado inicial
make info

# 2. Limpiar generaciones antiguas
make clean

# 3. Optimizar lo que queda
make optimize

# 4. Verificar espacio final
make info
```

**Nota importante:** Este proceso puede tomar tiempo, especialmente en stores grandes. Es seguro ejecutarlo en segundo plano, pero puede ralentizar otras operaciones de Nix mientras se ejecuta.

---

## ComparaciÃ³n de Comandos de Limpieza

| Comando | DÃ­as mantenidos | Espacio liberado | Seguridad | Uso recomendado |
|---------|----------------|------------------|-----------|----------------|
| `make clean-conservative` | 90 dÃ­as | 2-10 GB | â­â­â­â­â­ MÃ¡xima | ProducciÃ³n, primera vez |
| `make clean` | 30 dÃ­as | 5-20 GB | â­â­â­â­ Alta | Uso general, rutina mensual |
| `make clean-week` | 7 dÃ­as | 10-40 GB | â­â­ Media | Desarrollo, poco espacio |
| `make deep-clean` | 0 dÃ­as (TODO) | 20-100+ GB | â­ MÃ­nima | Emergencias Ãºnicamente |
| `make optimize` | N/A (no elimina) | 1-5 GB | â­â­â­â­â­ Seguro | DespuÃ©s de limpieza, rutina |

---

## Flujos de Trabajo Recomendados

### Flujo de Mantenimiento Mensual (Recomendado)

```bash
# 1. Verificar estado actual
make info

# 2. Limpiar generaciones antiguas
make clean

# 3. Optimizar el store
make optimize

# 4. Verificar espacio liberado
make info

# 5. Opcional: Ver generaciones restantes
make list-generations
```

### Flujo de Emergencia (Poco Espacio)

```bash
# 1. Verificar espacio crÃ­tico
make info

# 2. Limpieza agresiva pero segura
make clean-week

# 3. Optimizar
make optimize

# 4. Si aÃºn necesitas mÃ¡s espacio (Â¡cuidado!)
# make deep-clean  # Solo si estÃ¡s 100% seguro
```

### Flujo Conservador (MÃ¡xima Seguridad)

```bash
# 1. Verificar estado
make info

# 2. Limpieza conservadora
make clean-conservative

# 3. Optimizar
make optimize

# 4. Verificar
make info
```

---

## Mejores PrÃ¡cticas

1. **Limpia regularmente**: Ejecuta `make clean` al menos una vez al mes
2. **Verifica antes y despuÃ©s**: Usa `make info` para ver el impacto
3. **Combina con optimize**: DespuÃ©s de limpiar, optimiza para maximizar espacio
4. **MantÃ©n generaciones importantes**: Si sabes que una generaciÃ³n es importante, no la elimines
5. **Usa Git para historial**: Los comandos de limpieza no afectan tu historial de Git
6. **Empieza conservador**: Si es tu primera vez, usa `make clean-conservative`
7. **Monitorea el espacio**: Revisa periÃ³dicamente con `make info` o `df -h /nix/store`

---

## Resumen RÃ¡pido

```bash
# Limpieza estÃ¡ndar (30 dÃ­as)
make clean

# Limpieza semanal (7 dÃ­as) - mÃ¡s agresiva
make clean-week

# Limpieza conservadora (90 dÃ­as) - mÃ¡s segura
make clean-conservative

# Optimizar store (no elimina, solo optimiza)
make optimize

# Ver estado del sistema
make info

# Ver generaciones disponibles
make list-generations
```

---

#### `make generation-sizes`
Muestra el tamaÃ±o en disco de cada generaciÃ³n del sistema.

```bash
make generation-sizes
# Ãštil para ver quÃ© generaciones ocupan mÃ¡s espacio
```

---

<a id="cmd-updates"></a>
### ğŸ“¦ Updates

#### `make update`
Actualiza todas las inputs del flake (nixpkgs, hydenix, home-manager).

```bash
make update
```

**QuÃ© actualiza:**
```nix
inputs = {
  nixpkgs.url = "github:nixos/nixpkgs/nixos-unstable";  # â† se actualiza
  hydenix.url = "github:richen604/hydenix";              # â† se actualiza
  home-manager.url = "github:nix-community/home-manager"; # â† se actualiza
};
```

**CuÃ¡ndo usarlo:**
- Una vez por semana
- Para obtener Ãºltimas versiones de software
- Antes de instalar nuevo software

**âš ï¸ Importante:** DespuÃ©s de update, debes hacer `make switch` para aplicar.

**Flujo recomendado:**
```bash
make update           # Actualiza inputs
make dry-run          # Ve quÃ© cambiarÃ­a
make test             # Prueba la nueva config
make switch           # Si todo estÃ¡ bien, aplica
# Si algo falla:
make rollback         # Vuelve a versiÃ³n anterior
```

---

#### `make update-nixpkgs`
Actualiza solo nixpkgs (repositorio principal de paquetes).

```bash
make update-nixpkgs
```

**CuÃ¡ndo usarlo:**
- Quieres nuevo software pero no cambiar hydenix
- Update selectiva
- Debugging de incompatibilidades

---

#### `make update-hydenix`
Actualiza solo el framework hydenix.

```bash
make update-hydenix
```

**CuÃ¡ndo usarlo:**
- Nueva versiÃ³n de hydenix disponible
- Nuevas features de hydenix
- Fixes en hydenix

---

#### `make update-input INPUT=nombre`
Actualiza solo un input especÃ­fico del flake.

```bash
make update-input INPUT=hydenix
# Actualiza solo hydenix, no nixpkgs ni otros
```

**Inputs disponibles:**
- nixpkgs
- hydenix
- nixos-hardware
- mynixpkgs
- opencode
- zen-browser-flake

---


#### `make diff-update`
Muestra cambios en flake.lock despuÃ©s de un update.

```bash
make update
make diff-update
# Ve quÃ© cambiÃ³ exactamente
```

---

#### `make upgrade`
Combo: actualiza inputs + rebuild. **Comando todo-en-uno**.

```bash
make upgrade
# Equivalente a:
# make update
# make switch
```

**âš ï¸ Cuidado:** Aplica cambios inmediatamente. Mejor usar:
```bash
make update && make dry-run && make test && make switch
```

---


#### `make list-generations`
Lista todas las generaciones del sistema con fechas y resumen.

```bash
make list-generations
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“‹ System Generations                    
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Total generations: 33
Current generation: 33

All generations:
   1   2026-01-12 07:36:26
   2   2026-01-12 19:33:50
   ...
  33   2026-01-17 23:59:11   (current)
```

**CuÃ¡ndo usarlo:**
- Ver historial de cambios
- Antes de rollback (para elegir generaciÃ³n)
- Verificar cuÃ¡ntas generaciones tienes

---

#### `make rollback`
Revierte el sistema a la generaciÃ³n anterior inmediatamente. Es tu red de seguridad cuando algo sale mal.

```bash
make rollback
```

**QuÃ© hace:**
- âœ… Activa la generaciÃ³n anterior (N-1) inmediatamente
- âœ… Cambios disponibles de forma instantÃ¡nea
- âœ… No elimina la generaciÃ³n "mala" (puedes volver a ella si quieres)
- âœ… Restaura el estado del sistema que funcionaba antes

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          âª Revertir a GeneraciÃ³n Anterior         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Revirtiendo a la generaciÃ³n anterior...
Esto restaurarÃ¡ la configuraciÃ³n del sistema anterior.

[output del rollback...]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Rollback completado
El sistema ha vuelto a la generaciÃ³n anterior.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Â¿Por quÃ© es Ãºtil?**
- **RecuperaciÃ³n rÃ¡pida:** Vuelve al estado anterior en segundos
- **Sin pÃ©rdida de datos:** No elimina archivos ni configuraciones de usuario
- **Seguridad:** Siempre puedes volver si algo sale mal
- **Sin miedo:** Permite experimentar sabiendo que puedes revertir

**CuÃ¡ndo usarlo:**
- DespuÃ©s de `make switch` que rompiÃ³ algo
- Sistema no funciona correctamente despuÃ©s de un cambio
- Quieres deshacer el Ãºltimo cambio aplicado
- Necesitas volver rÃ¡pidamente a un estado conocido que funcionaba
- DespuÃ©s de cambios experimentales que no funcionaron como esperabas

**Casos de uso reales:**

**Ejemplo 1: RecuperaciÃ³n despuÃ©s de cambio problemÃ¡tico**
```bash
# Aplicas cambios
make switch

# Algo se rompe (servicios no inician, errores, etc.)
# Revierte inmediatamente
make rollback

# El sistema vuelve a funcionar
# Ahora investigas quÃ© saliÃ³ mal
make debug
```

**Ejemplo 2: Deshacer cambio experimental**
```bash
# Pruebas una configuraciÃ³n nueva
make switch

# No funciona como esperabas
make rollback

# Vuelves a la normalidad y puedes intentar otra cosa
```

**Ejemplo 3: Flujo de trabajo seguro**
```bash
# 1. Aplicas cambios
make switch

# 2. Si algo falla, reviertes
make rollback

# 3. Investigas el problema
make debug
# o
make validate

# 4. Corriges y vuelves a intentar
make switch
```

**Ventajas:**
- âœ… RecuperaciÃ³n instantÃ¡nea
- âœ… No pierdes datos ni configuraciones
- âœ… Permite experimentar con seguridad
- âœ… No elimina la generaciÃ³n problemÃ¡tica (puedes investigarla despuÃ©s)
- âœ… Cambios disponibles inmediatamente

**Limitaciones:**
- âš ï¸ Solo revierte a la generaciÃ³n anterior (N-1)
- âš ï¸ Si necesitas volver mÃ¡s atrÃ¡s, usa `make list-generations` y selecciona en GRUB
- âš ï¸ No restaura archivos de configuraciÃ³n editados manualmente (usa Git para eso)

**RelaciÃ³n con otros comandos:**
- `make list-generations` - Ver todas las generaciones disponibles
- `make diff-generations` - Comparar generaciÃ³n actual con anterior
- `make switch` - Aplicar cambios (puedes revertir con rollback)
- Git - Para restaurar archivos de configuraciÃ³n especÃ­ficos

**Nota importante:** `make rollback` solo revierte la configuraciÃ³n del sistema. Si editaste archivos de configuraciÃ³n manualmente y quieres restaurarlos, usa Git:
```bash
# Restaurar archivo especÃ­fico con Git
git checkout HEAD~1 -- path/to/file.nix
make switch
```

---

#### `make diff-generations`
Compara la generaciÃ³n actual con la generaciÃ³n anterior usando `nix store diff-closures`, mostrando quÃ© paquetes fueron aÃ±adidos, eliminados o actualizados.

```bash
make diff-generations
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“Š Comparing Generations                  
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Previous â†’ Current
Comparing: nixos-system-hydenix-26.05.20251229.95e96e8 â†’ nixos-system-hydenix-26.05.20251229.95e96e8

[lista detallada de paquetes aÃ±adidos/eliminados/actualizados con tamaÃ±os]
```

**Â¿CÃ³mo funciona?**

1. **Obtiene rutas del store:** Usa `readlink -f` para obtener las rutas completas del store de Nix de la generaciÃ³n actual y la anterior
2. **Compara closures:** Usa `nix store diff-closures` para comparar los closures completos de ambas generaciones
3. **Muestra diferencias:** Lista todos los paquetes que cambiaron, incluyendo:
   - Paquetes aÃ±adidos (aparecen solo en la generaciÃ³n actual)
   - Paquetes eliminados (aparecen solo en la generaciÃ³n anterior)
   - Paquetes actualizados (versiones diferentes)
   - TamaÃ±os de los cambios

**Â¿Para quÃ© sirve?**

- **Entender cambios:** Ver exactamente quÃ© paquetes cambiaron entre la Ãºltima generaciÃ³n y la actual
- **Debugging:** Identificar quÃ© paquetes podrÃ­an estar causando problemas despuÃ©s de un rebuild
- **AuditorÃ­a:** Revisar quÃ© se instalÃ³ o actualizÃ³ en cada cambio de configuraciÃ³n
- **OptimizaciÃ³n:** Identificar paquetes grandes que se agregaron para decidir si son necesarios

**CuÃ¡ndo usarlo:**
- DespuÃ©s de hacer `make switch` para ver quÃ© cambiÃ³
- Cuando algo no funciona despuÃ©s de un rebuild y quieres ver quÃ© paquetes cambiaron
- Para entender el impacto de una actualizaciÃ³n antes de aplicarla
- Como parte del workflow de mantenimiento del sistema

**Notas:**
- Requiere que `nix store diff-closures` estÃ© disponible (Nix 2.4+)
- La salida puede ser muy larga si hay muchos cambios
- Compara los closures completos, no solo los paquetes explÃ­citos
- Si no hay generaciÃ³n anterior o es la misma que la actual, muestra un mensaje informativo

---

#### `make diff-gen GEN1=N GEN2=M`
Compara dos generaciones especÃ­ficas usando `nix store diff-closures`, mostrando quÃ© paquetes y archivos cambiaron entre ellas.

```bash
make diff-gen GEN1=32 GEN2=33
# Compara generaciÃ³n 32 vs 33
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“Š Comparing Generations                  
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Generation 32 â†’ Generation 33
Comparing:  nngjvi4bcyaw3d0jsdi1w62569llz8hi-nixos-system-hydenix-26.05.20251229.95e96e8 â†’ 0hgc735ijn3yngk7cgkad6g6g0fk062f-nixos-system-hydenix-26.05.20251229.95e96e8

hm_config.toml: âˆ… â†’ Îµ
```

**Â¿CÃ³mo interpretar la salida?**

La salida de `nix store diff-closures` usa una notaciÃ³n especÃ­fica:

- **`âˆ…` (vacÃ­o)**: No existÃ­a o no estaba presente en la generaciÃ³n anterior
- **`Îµ` (epsilon)**: Presente o modificado en la generaciÃ³n nueva
- **Versiones diferentes**: Muestra ambas versiones separadas por `â†’` (ej: `firefox-120.0 â†’ firefox-121.0`)

**Ejemplos de interpretaciÃ³n:**

- `paquete: âˆ… â†’ 1.0` = Paquete fue **agregado** en la generaciÃ³n nueva
- `paquete: 1.0 â†’ âˆ…` = Paquete fue **eliminado** en la generaciÃ³n nueva
- `paquete: 1.0 â†’ 2.0` = Paquete fue **actualizado** de versiÃ³n 1.0 a 2.0
- `archivo.toml: âˆ… â†’ Îµ` = Archivo fue **agregado o modificado** (cambio mÃ­nimo)

**Â¿Para quÃ© sirve?**

- **Comparar generaciones especÃ­ficas:** Ãštil cuando quieres comparar dos generaciones que no son consecutivas
- **Debugging histÃ³rico:** Ver quÃ© cambiÃ³ entre una generaciÃ³n que funcionaba y una que no
- **AuditorÃ­a:** Entender quÃ© cambios se hicieron en un momento especÃ­fico del tiempo
- **Rollback informado:** Antes de hacer rollback, ver exactamente quÃ© se perderÃ¡

**CuÃ¡ndo usarlo:**
- Cuando necesitas comparar generaciones que no son consecutivas
- Para investigar quÃ© cambiÃ³ entre una generaciÃ³n estable y una problemÃ¡tica
- Antes de hacer rollback para entender quÃ© se revertirÃ¡
- Para comparar el estado actual con una generaciÃ³n anterior especÃ­fica

**RelaciÃ³n con otros comandos:**
- `make diff-generations` - Compara automÃ¡ticamente la generaciÃ³n actual con la anterior
- `make diff-gen GEN1=N GEN2=M` - Compara dos generaciones especÃ­ficas que tÃº elijas
- `make list-generations` - Lista todas las generaciones disponibles para comparar

---

<a id="cmd-git"></a>
### ğŸ”§ Git Integration

#### `make git-status`
Muestra estado completo del repositorio y configuraciÃ³n del sistema.

```bash
make git-status
```

**Output:**
- **Configuration**: Hostname, Flake Location, NixOS Version
- **Git Status**: Repository, Branch, Status
- **Local changes**: Archivos modificados con formato colorido de git
- **Recent Changes**: Ãšltimos 3 commits con formato compacto

---

#### `make git-add`
Stages todos los cambios con formato visual mejorado.

```bash
make git-add
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              ğŸ“ Staging Changes                   
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Adding all changes to staging area...
âœ… Staged 3 file(s)

Changes staged:
  M Makefile
  M docs/makefile.mdx
  A new-file.nix
```

---

#### `make git-commit`
Commit rÃ¡pido con timestamp automÃ¡tico y formato visual mejorado.

```bash
make git-commit
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ“ Committing Changes                  
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Staging changes...
Creating commit: config: update 2026-01-18 10:48:16

âœ… Commit created successfully
Hash: 71d24b4
Branch: main
```

**Mejor prÃ¡ctica:** Usa mensajes descriptivos manualmente:
```bash
git add .
git commit -m "feat: add kitty terminal config"
```

---

#### `make git-push`
Push al remoto con formato visual mejorado.

```bash
make git-push
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              ğŸš€ Pushing to Remote                 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Branch: main
Remote: 25ASAB015/nix-dotfiles

Pushing changes...
[output de git push]

âœ… Successfully pushed to remote
```

---

#### `make sync`
**SincronizaciÃ³n total:** add + commit + push + rebuild todo en uno con workflow visual.

```bash
make sync
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              ğŸ”„ Total Synchronization              
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Executing complete workflow:
  1. Stage changes
  2. Commit changes
  3. Push to remote
  4. Build and switch

[ejecuta cada paso con su formato visual]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Synchronization completed successfully!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**QuÃ© hace:**
1. `make git-add` - Stage cambios
2. `make git-commit` - Commit con timestamp
3. `make git-push` - Push al remoto
4. `make switch` - Build y switch

**âš ï¸ Ãšsalo con cuidado:** Es conveniente pero hace commits automÃ¡ticos. Mejor para cambios pequeÃ±os.

**Mejor prÃ¡ctica:**
```bash
# Para cambios pequeÃ±os:
make save

# Para cambios importantes:
git add .
git commit -m "feat: descripciÃ³n clara del cambio"
git push
make switch
```

---

#### `make git-log`
Muestra los Ãºltimos 15 commits en formato compacto y visual.

```bash
make git-log
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ğŸ“ Recent Changes                      
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  de95dff   refactor: remove make packages command and update docs    3 minutes ago
  a9a8e70   feat: combine list-hosts and hosts-info, update docs...   7 minutes ago
  c4dbec9   feat: improve list-generations output format with...  12 minutes ago
  c6830ae   fix: improve search-installed to find packages in...  17 minutes ago
```

**CaracterÃ­sticas:**
- Formato compacto: cada commit en una lÃ­nea
- Mensajes truncados a 55 caracteres si son muy largos
- Columna de tiempo alineada a la derecha
- Hash en verde, tiempo en azul

**Resumen de comandos Git Integration:**
- `git-status` - Estado completo del repositorio y sistema
- `git-add` - Stage cambios
- `git-commit` - Commit con timestamp
- `git-push` - Push al remoto
- `git-diff` - Ver cambios sin commitear en archivos .nix
- `git-log` - Ver historial de commits (Ãºltimos 15)
- `sync` - Workflow completo: add + commit + push + rebuild


<a id="cmd-system-info"></a>
### ğŸ“Š System Information

#### `make info`
Muestra informaciÃ³n completa del sistema, incluyendo generaciones y uso de disco.

```bash
make info
```

**Output ejemplo:**
```
â³ Gathering system information, please wait...
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸ’» System Information                    
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Hostname:             hydenix
NixOS Version:        26.05.20251229.95e96e8
Flake Location:       /home/ludus/Dotfiles

ğŸ’¾ System Info
Store Size:            71G
Current Generation:    33 (2026-01-17 23:59:11)
Total Generations:     33
Disk Usage (/nix):     47%

ğŸ”„ Recent Generations
    29   2026-01-15 06:38:07
    30   2026-01-15 08:45:09
    31   2026-01-15 09:10:08
    32   2026-01-17 23:37:08
    33   2026-01-17 23:59:11   (current)

ğŸ“¦ Flake Inputs Versions
  1768753617
  1768753617
  1768135262
  1768135262
  1762440070
```

**CuÃ¡ndo usarlo:**
- Verificar tamaÃ±o de `/nix/store`
- Ver informaciÃ³n de generaciones del sistema
- Verificar uso de disco
- Ver versiÃ³n de NixOS
- Debugging general

---

#### `make status`
Alias de `make git-status` para mantener compatibilidad.

```bash
make status
# Equivalente a: make git-status
```

Muestra la misma informaciÃ³n que `make git-status`: configuraciÃ³n del sistema y estado completo del repositorio git.

---

#### `make current-generation`
Muestra detalles de la generaciÃ³n actual con formato visual mejorado.

```bash
make current-generation
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        ğŸ“ Current Generation Details              
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  33   2026-01-17 23:59:11   (current)

Activation date:  2026-01-18 06:08:36
Closure size:  40.5G
```

#### `make hosts-info`
Alias de `make list-hosts` para mantener compatibilidad. Muestra la misma informaciÃ³n detallada de todos los hosts configurados.

---


<a id="cmd-search"></a>
### ğŸ” BÃºsqueda

#### `make search PKG=nombre`
Busca paquetes en nixpkgs.

```bash
make search PKG=firefox
# Busca firefox en todos los paquetes disponibles
```

#### `make search-installed PKG=nombre`
Busca en paquetes ya instalados en tu sistema, incluyendo PATH y perfiles de Home Manager.

```bash
make search-installed PKG=kitty
```

**Output ejemplo:**
```
ğŸ” Searching installed packages for: kitty
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Executable in PATH:
  âœ“ Found: /etc/profiles/per-user/ludus/bin/kitty
  Store path: /nix/store/abc123-kitty-0.30.1

2. User environment (nix-env):
  Not found

3. System packages (current-system):
  /nix/store/abc123-kitty-0.30.1

4. Home Manager profiles:
  /etc/profiles/per-user/ludus/bin/kitty
```

**Mejoras:** Ahora busca en mÃºltiples ubicaciones:
- Ejecutables en PATH
- Entorno de usuario (nix-env)
- Paquetes del sistema
- Perfiles de Home Manager

---

<a id="cmd-quick-actions"></a>
### âš¡ Quick Actions

Estos comandos estÃ¡n diseÃ±ados para situaciones especÃ­ficas donde los comandos estÃ¡ndar no son suficientes. Cada uno tiene un propÃ³sito Ãºnico y no son redundantes.

---

#### `make switch-fast`
Rebuild rÃ¡pido (Switch Fast) omitiendo verificaciones internas de NixOS para acelerar el proceso.

```bash
make switch-fast
```

**QuÃ© hace:**
- Ejecuta `nixos-rebuild switch` con la opciÃ³n `--fast`
- Omite verificaciones internas del sistema (compilaciÃ³n mÃ¡s rÃ¡pida)
- Aplica cambios directamente
- MÃ¡s rÃ¡pido que `make switch` estÃ¡ndar cuando el sistema ya tiene las dependencias en el store

**âš ï¸ Advertencias:**
- No valida la configuraciÃ³n antes de aplicar
- No muestra quÃ© se construirÃ¡ antes de hacerlo
- Puede fallar si hay errores en la configuraciÃ³n
- Ãšsalo solo cuando estÃ©s 100% seguro de tus cambios

**CuÃ¡ndo usarlo:**
- **Desarrollo iterativo rÃ¡pido**: Cuando estÃ¡s haciendo cambios pequeÃ±os y frecuentes
- **Ya validaste antes**: DespuÃ©s de `make validate` o `make test` exitosos
- **Cambios triviales**: Modificaciones que sabes que funcionarÃ¡n (ej: cambiar un color)
- **Necesitas velocidad**: Cuando el tiempo es crÃ­tico y confÃ­as en tu configuraciÃ³n

**CuÃ¡ndo NO usarlo:**
- Primera vez que modificas algo
- Cambios complejos o importantes
- No has probado la configuraciÃ³n antes
- Sistema de producciÃ³n

**ComparaciÃ³n con otros comandos:**
- `make switch` - Incluye verificaciones bÃ¡sicas, mÃ¡s seguro
- `make safe-switch` - Valida antes de aplicar, mÃ¡s seguro aÃºn
- `make switch-fast` - Sin verificaciones, mÃ¡s rÃ¡pido y omite verificaciones internas de nixos-rebuild

**Ejemplo de uso:**
```bash
# 1. Validar primero (una vez)
make validate

# 2. Cambio pequeÃ±o (ej: ajustar un color)
# Editar configuraciÃ³n...

# 3. Aplicar rÃ¡pido (confÃ­as que funcionarÃ¡)
make switch-fast

# Si algo falla, siempre puedes hacer rollback
make rollback
```

---

#### `make emergency`
Rebuild con mÃ¡xima verbosidad y debugging para diagnosticar problemas crÃ­ticos.

```bash
make emergency
```

**QuÃ© hace:**
- Ejecuta `nixos-rebuild switch` con:
  - `--show-trace` - Muestra trazas completas de evaluaciÃ³n
  - `--verbose` - Output extremadamente detallado
  - `--option eval-cache false` - Desactiva cachÃ© de evaluaciÃ³n (fuerza reconstrucciÃ³n completa)
- Proporciona informaciÃ³n mÃ¡xima para debugging
- Ãštil cuando el sistema no arranca o hay problemas crÃ­ticos

**âš ï¸ Advertencias:**
- **Muy lento**: Puede tomar 2-5x mÃ¡s tiempo que un rebuild normal
- **Output masivo**: Genera muchÃ­sima informaciÃ³n (puede ser abrumador)
- **Desactiva cachÃ©**: Reconstruye todo desde cero, mÃ¡s lento pero mÃ¡s preciso

**CuÃ¡ndo usarlo:**
- **Sistema no arranca**: Cuando el sistema fallÃ³ al iniciar despuÃ©s de un switch
- **Errores crÃ­ticos**: Problemas que `make debug` no pudo resolver
- **Reportar bugs**: Cuando necesitas informaciÃ³n detallada para reportar un problema
- **Problemas de evaluaciÃ³n**: Cuando sospechas que hay problemas en la evaluaciÃ³n de Nix
- **CachÃ© corrupta**: Cuando sospechas que el cachÃ© estÃ¡ causando problemas

**CuÃ¡ndo NO usarlo:**
- Uso diario normal (es demasiado lento)
- Cambios simples (usa `make switch` o `make switch-fast`)
- Cuando `make debug` es suficiente

**ComparaciÃ³n con otros comandos:**
- `make debug` - Verbosidad moderada, Ãºtil para la mayorÃ­a de casos
- `make emergency` - Verbosidad mÃ¡xima, solo para problemas crÃ­ticos
- `make switch` - Output normal, uso diario

**Ejemplo de flujo de debugging:**
```bash
# 1. Intento normal
make switch
# â†’ Falla con error crÃ­ptico

# 2. MÃ¡s informaciÃ³n
make debug
# â†’ AÃºn no suficiente informaciÃ³n

# 3. Modo emergencia (mÃ¡xima informaciÃ³n)
make emergency
# â†’ Output masivo con trazas completas
# â†’ Ahora puedes identificar el problema exacto
```

---

#### `make deep-clean`
Limpieza agresiva que elimina **TODAS** las generaciones antiguas. âš ï¸ **IRREVERSIBLE**

```bash
make deep-clean
# PedirÃ¡ confirmaciÃ³n: escribir "yes"
```

**QuÃ© elimina:**
- **TODAS** las generaciones del sistema (excepto la actual)
- **TODAS** las generaciones de usuario
- **TODOS** los paquetes no referenciados por la generaciÃ³n actual
- MÃ¡xima liberaciÃ³n de espacio posible

**Espacio liberado tÃ­pico:** 20-100+ GB (depende del tamaÃ±o del store)

**âš ï¸ ADVERTENCIAS CRÃTICAS:**
- **IRREVERSIBLE**: No podrÃ¡s hacer rollback a NINGUNA generaciÃ³n anterior
- **Sin red de seguridad**: Si algo falla despuÃ©s, no hay vuelta atrÃ¡s
- **Solo la generaciÃ³n actual**: Solo podrÃ¡s usar la configuraciÃ³n actual

**CuÃ¡ndo usarlo:**
- **Emergencia de espacio**: Disco casi lleno y necesitas espacio inmediatamente
- **DespuÃ©s de migraciÃ³n exitosa**: Cuando migraste a nuevo sistema y todo funciona perfecto
- **Sistema funcionando perfectamente**: ConfiguraciÃ³n estable sin cambios recientes
- **Ãšltimo recurso**: Cuando otros comandos de limpieza no liberaron suficiente espacio

**CuÃ¡ndo NO usarlo:**
- **Nunca en producciÃ³n** sin razÃ³n crÃ­tica
- Si hiciste cambios recientes importantes
- Si no estÃ¡s 100% seguro de que tu configuraciÃ³n actual funciona perfectamente
- Como rutina de mantenimiento (usa `make clean` en su lugar)

**ComparaciÃ³n con otros comandos de limpieza:**
- `make clean` - Mantiene 30 dÃ­as, seguro para uso regular
- `make clean-week` - Mantiene 7 dÃ­as, mÃ¡s agresivo pero seguro
- `make clean-conservative` - Mantiene 90 dÃ­as, mÃ¡xima seguridad
- `make deep-clean` - Elimina TODO, solo para emergencias

**Flujo recomendado antes de usar:**
```bash
# 1. Verificar que el sistema funciona perfectamente
make info

# 2. Intentar limpieza normal primero
make clean
# o
make clean-week

# 3. Verificar espacio liberado
make info

# 4. Si aÃºn necesitas mÃ¡s espacio Y estÃ¡s seguro:
make deep-clean
# â†’ Escribe "yes" para confirmar
```

**Proceso de confirmaciÃ³n:**
El comando pedirÃ¡ confirmaciÃ³n escribiendo "yes" exactamente. Esto previene ejecuciones accidentales.

---


<a id="cmd-hardware"></a>
### ğŸ”© Hardware

#### `make hardware-scan`
Re-detecta hardware y genera nueva configuraciÃ³n.

```bash
make hardware-scan
```

**QuÃ© hace:**
- Escanea todo el hardware
- Genera `hardware-configuration-new.nix`
- NO sobrescribe el actual

**CuÃ¡ndo usarlo:**
- Cambiaste hardware (GPU, disco, etc)
- Moviste disco a otra mÃ¡quina
- Problemas de detecciÃ³n de hardware

**Flujo:**
```bash
make hardware-scan
diff hardware-configuration.nix hardware-configuration-new.nix
# Revisa diferencias
mv hardware-configuration-new.nix hardware-configuration.nix
make switch
```

---

<a id="cmd-monitoring"></a>
### ğŸ“¡ Monitoring

#### `make watch-logs`
Monitorea los logs del sistema en tiempo real usando `journalctl -f` (modo follow).

```bash
make watch-logs
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“Š Watching System Logs                   
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Press Ctrl+C to exit

Jan 18 13:28:32 hydenix hypridle[339158]: Device 'input2::numlock'...
Jan 18 13:28:46 hydenix hypridle[10122]: [LOG] Resumed: rule 55d4a0439f40
Jan 18 13:29:23 hydenix ghostty[206074]: info(stream): OSC 1 received...
```

**Â¿Para quÃ© sirve?**
- **Monitoreo en tiempo real:** Ver eventos del sistema conforme ocurren
- **Debugging activo:** Identificar problemas mientras suceden
- **Seguimiento durante builds:** Observar logs mientras se ejecuta `make switch` en otra terminal
- **AnÃ¡lisis de servicios:** Ver cÃ³mo responden los servicios a cambios o eventos
- **Troubleshooting interactivo:** Detectar patrones o errores repetitivos en tiempo real

**CaracterÃ­sticas:**
- Usa `journalctl -f` (follow mode) para mostrar logs en tiempo real
- Muestra todos los logs del sistema (kernel, servicios, aplicaciones)
- Formato consistente con otros comandos de diagnÃ³stico
- Instrucciones claras para salir (`Ctrl+C`)

**CuÃ¡ndo usarlo:**
- Durante un `make switch` para ver quÃ© estÃ¡ pasando
- Cuando un servicio no funciona correctamente y necesitas ver sus logs en vivo
- Para monitorear el sistema despuÃ©s de hacer cambios de configuraciÃ³n
- Cuando sospechas que hay actividad sospechosa o errores recurrentes
- Para entender el comportamiento del sistema durante operaciones especÃ­ficas

**Workflow tÃ­pico:**
```bash
# Terminal 1: Monitorear logs
make watch-logs

# Terminal 2: Ejecutar operaciÃ³n
make switch

# Los logs aparecerÃ¡n en tiempo real en Terminal 1
```

**Salir:** Presiona `Ctrl + C` para detener el monitoreo.

---

#### `make logs-boot`
Muestra los logs de arranque (errores y alertas) con formato visual mejorado.

```bash
make logs-boot
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“‹ Boot Logs                              
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Showing errors and alerts from current boot...

[logs de errores y alertas del boot actual]
```

**CaracterÃ­sticas:**
- Formato visual consistente con otros comandos
- Muestra solo errores y alertas del boot actual
- Ãšltimos 50 mensajes relevantes
- Ãštil para diagnosticar problemas al iniciar el sistema

**CuÃ¡ndo usarlo:**
- Cuando el sistema tiene problemas al arrancar
- Para diagnosticar errores de hardware detectados durante el boot
- Verificar si hay problemas con servicios que inician al arranque

#### `make logs-errors`
Muestra los Ãºltimos 50 errores del sistema con formato visual mejorado.

```bash
make logs-errors
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“‹ Recent Error Logs                      
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Showing last 50 error-level messages
Found: 50 error message(s)

Jan 18 08:00:27 hydenix kernel: serial 00:01: PM: failed to resume: error -5
Jan 18 08:00:27 hydenix kernel: usb 1-6: device descriptor read/64, error -71
...
```

**CaracterÃ­sticas:**
- Muestra contador de errores encontrados
- Formato visual consistente con otros comandos
- Ãšltimos 50 mensajes de nivel error del sistema
- Incluye mensaje cuando no hay errores recientes

**CuÃ¡ndo usarlo:**
- Para diagnosticar problemas del sistema
- DespuÃ©s de un error para ver quÃ© pasÃ³
- Como parte del troubleshooting general
- Para monitorear errores recurrentes

#### `make logs-service SVC=nombre`
Muestra logs de un servicio especÃ­fico con formato visual mejorado y filtrado inteligente por tiempo.

```bash
make logs-service SVC=sshd
make logs-service SVC=networkmanager
make logs-service SVC=docker
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“‹ Service Logs                           
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Service: sshd
No recent logs (last hour), showing logs from today...

[logs del servicio de hoy]
```

**CaracterÃ­sticas:**
- **Filtrado inteligente por tiempo:**
  - Primero intenta mostrar logs de la Ãºltima hora (mÃ¡s relevantes)
  - Si no hay logs recientes, muestra logs de hoy
  - Si tampoco hay logs de hoy, muestra los Ãºltimos 100 logs sin filtro de tiempo
- Formato visual consistente con otros comandos
- Muestra el nombre del servicio destacado
- Filtra mensajes vacÃ­os de journalctl (`-- No entries --`)
- Manejo de errores si el servicio no existe
- Mensajes informativos sobre quÃ© rango de tiempo estÃ¡ mostrando

**CuÃ¡ndo usarlo:**
- Para diagnosticar problemas de un servicio especÃ­fico
- Ver actividad reciente de un servicio (Ãºltima hora o hoy)
- Debugging de servicios que no funcionan correctamente
- Monitorear actividad de servicios en tiempo real

**Ejemplos:**
```bash
make logs-service SVC=sshd              # Logs de SSH
make logs-service SVC=networkmanager   # Logs de NetworkManager
make logs-service SVC=docker           # Logs de Docker
make logs-service SVC=systemd-journald # Logs del journal
```

**Cuando no se proporciona SVC:**
Si ejecutas `make logs-service` sin el parÃ¡metro `SVC`, verÃ¡s un mensaje de ayuda Ãºtil que incluye:
- Ejemplos de uso
- Lista de servicios comunes en ejecuciÃ³n
- Tip para ver todos los servicios disponibles

**Output cuando falta SVC:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“‹ Service Logs                           
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ Error: SVC variable required

Usage: make logs-service SVC=<service-name>

Examples:
  make logs-service SVC=sshd
  make logs-service SVC=networkmanager
  make logs-service SVC=docker

Common services:
  dbus-broker.service
  display-manager.service
  NetworkManager.service
  nix-daemon.service
  sshd.service
  systemd-journald.service
  ...

Tip: Use systemctl list-units --type=service to see all services
```

---

<a id="cmd-advanced"></a>
### ğŸ§  Advanced

#### `make repl`
Abre un REPL interactivo de Nix con tu flake cargado.

```bash
make repl
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#           ğŸ§  Nix REPL - Interactive Shell           
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# Starting Nix REPL with flake loaded...
# Useful commands:
#   :q or :quit - Exit REPL
#   outputs - View flake outputs
#   outputs.nixosConfigurations.hydenix - View configuration
# 
# nix-repl> outputs.nixosConfigurations.hydenix.config.services
# nix-repl> :q
```

**QuÃ© puedes hacer:**
```nix
nix-repl> outputs                              # Ver todos los outputs del flake
nix-repl> outputs.nixosConfigurations.hydenix  # Ver configuraciÃ³n especÃ­fica
nix-repl> outputs.packages.x86_64-linux.vm     # Ver paquetes disponibles
nix-repl> :q                                   # Salir del REPL
```

**CuÃ¡ndo usarlo:**
- Explorar configuraciones sin editar archivos
- Testing de expresiones Nix interactivamente
- Aprender Nix y entender cÃ³mo funciona tu configuraciÃ³n
- Debugging: ver valores de configuraciones en tiempo real
- Verificar que las expresiones Nix son correctas antes de aplicar

---

#### `make shell`
Entra a un shell de desarrollo del flake.

```bash
make shell
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#           ğŸš Development Shell                      
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# Entering development shell...
# This shell includes development tools from your flake.
```

**Requisitos:**
- El flake debe tener `devShells` configurado
- Si no estÃ¡ configurado, el comando mostrarÃ¡ instrucciones

**CuÃ¡ndo usarlo:**
- Desarrollo con herramientas especÃ­ficas del proyecto
- Entornos de desarrollo reproducibles
- Testing con dependencias especÃ­ficas

**Nota:** Si no tienes `devShells` configurado, el comando mostrarÃ¡ cÃ³mo agregarlo.

---

#### `make vm`
Construye y ejecuta una VM de tu configuraciÃ³n NixOS.

```bash
make vm
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#           ğŸ–¥ï¸  NixOS Virtual Machine               
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# Building VM from current configuration...
# This may take a few minutes on first build.
# 
# âœ… VM built successfully
# Starting VM...
# Press Ctrl+Alt+G to release mouse/keyboard
# Use 'systemctl poweroff' in VM to shutdown
```

**Ãštil para:**
- Testing sin riesgo: probar cambios sin afectar el sistema real
- Desarrollo: probar configuraciones en un entorno aislado
- Debugging: reproducir problemas en un entorno limpio
- Demostraciones: mostrar la configuraciÃ³n sin instalar
- ExperimentaciÃ³n: probar configuraciones nuevas con seguridad

**Controles de la VM:**
- `Ctrl+Alt+G`: Liberar mouse y teclado
- `systemctl poweroff`: Apagar la VM desde dentro
- `Ctrl+C`: Detener la VM (forzado)

**Nota:** La primera construcciÃ³n puede tardar varios minutos. Construcciones posteriores son mÃ¡s rÃ¡pidas gracias al cachÃ© de Nix.

---

<a id="cmd-export"></a>
### ğŸ“¤ Export/Import


<a id="cmd-docs"></a>
### ğŸ“š DocumentaciÃ³n

#### `make docs-local`
Lista toda la documentaciÃ³n local disponible en el repositorio.

```bash
make docs-local
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“š Local Documentation                    
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âœ“ README.md
  âœ“ docs/
    â”œâ”€ docs/README.md

ğŸ’¡ Tip: Use less <file> or cat <file> to view documentation
```

**Â¿Para quÃ© sirve?**

1. **Descubrir documentaciÃ³n disponible:** En lugar de explorar manualmente el repositorio, este comando te muestra rÃ¡pidamente quÃ© archivos de documentaciÃ³n estÃ¡n disponibles sin tener que navegar por el sistema de archivos.

2. **VerificaciÃ³n rÃ¡pida:** Ãštil cuando necesitas recordar quÃ© documentaciÃ³n existe o cuando estÃ¡s trabajando en un proyecto por primera vez y quieres saber quÃ© recursos de documentaciÃ³n estÃ¡n disponibles.

3. **NavegaciÃ³n eficiente:** Te indica dÃ³nde estÃ¡n los archivos de documentaciÃ³n, especialmente Ãºtil si hay documentaciÃ³n distribuida en diferentes ubicaciones (raÃ­z del proyecto, directorio `docs/`, `legacydocs/`, etc.).

4. **Workflow de lectura:** Permite acceder rÃ¡pidamente a la documentaciÃ³n desde la terminal sin necesidad de abrir un navegador o editor.

**CuÃ¡ndo usarlo:**
- Cuando necesitas encontrar documentaciÃ³n especÃ­fica pero no recuerdas dÃ³nde estÃ¡
- Al explorar el proyecto por primera vez
- Para verificar quÃ© documentaciÃ³n estÃ¡ disponible antes de hacer cambios
- Como punto de partida para entender la estructura de documentaciÃ³n del proyecto

**RelaciÃ³n con otros comandos:**
- `make docs-dev` - Inicia el servidor de desarrollo de la documentaciÃ³n web

---

#### `make docs-dev`
Inicia el servidor de desarrollo de documentaciÃ³n con Astro con instalaciÃ³n automÃ¡tica de dependencias.

```bash
make docs-dev
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“˜ Servidor de DocumentaciÃ³n              
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ Instalando dependencias primero...
[output de npm install si es necesario]

Iniciando servidor de desarrollo Astro...
La documentaciÃ³n estarÃ¡ disponible en http://localhost:4321
```

**QuÃ© hace:**
- Verifica automÃ¡ticamente si las dependencias estÃ¡n instaladas
- Si no existen `node_modules`, ejecuta `npm install` automÃ¡ticamente
- Inicia el servidor de desarrollo de Astro
- La documentaciÃ³n estarÃ¡ disponible en `http://localhost:4321`

**CuÃ¡ndo usarlo:**
- Previsualizar cambios en la documentaciÃ³n antes de publicar
- Desarrollo de documentaciÃ³n en tiempo real
- Ver cÃ³mo se ve la documentaciÃ³n en el navegador
- Primera vez que usas la documentaciÃ³n (instala deps automÃ¡ticamente)

**Ventajas:**
- âœ… InstalaciÃ³n automÃ¡tica de dependencias si no existen
- âœ… Hot reload: los cambios se reflejan inmediatamente
- âœ… No mÃ¡s errores de "command not found"
- âœ… Funciona incluso despuÃ©s de clonar el repo

---

#### `make docs-build`
Construye la documentaciÃ³n para producciÃ³n con instalaciÃ³n automÃ¡tica de dependencias.

```bash
make docs-build
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“¦ Construir DocumentaciÃ³n                
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Construyendo documentaciÃ³n para producciÃ³n...
[output del build de Astro]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… DocumentaciÃ³n construida exitosamente
Los archivos estÃ¡n en docs/dist/
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**QuÃ© hace:**
- Verifica automÃ¡ticamente si las dependencias estÃ¡n instaladas
- Si no existen `node_modules`, ejecuta `npm install` automÃ¡ticamente
- Construye la documentaciÃ³n optimizada para producciÃ³n
- Genera archivos estÃ¡ticos en `docs/dist/`

**CuÃ¡ndo usarlo:**
- Antes de deployar la documentaciÃ³n
- Para generar archivos estÃ¡ticos optimizados
- Testing de build en CI/CD
- Verificar que no hay errores de build

---

#### `make docs-install`
Instala o actualiza manualmente las dependencias de la documentaciÃ³n.

```bash
make docs-install
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“¦ Instalar Dependencias                  
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Instalando dependencias de npm...
[output de npm install]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Dependencias instaladas
La documentaciÃ³n estÃ¡ lista para usar.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**CuÃ¡ndo usarlo:**
- Actualizar dependencias despuÃ©s de cambios en `package.json`
- Forzar reinstalaciÃ³n de dependencias
- Resolver problemas de dependencias corruptas
- DespuÃ©s de cambiar de rama con diferentes versiones

---

#### `make docs-clean`
Limpia las dependencias de la documentaciÃ³n (elimina `node_modules`).

```bash
make docs-clean
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ§¹ Limpiar Dependencias                   
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Limpiando dependencias de la documentaciÃ³n...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Dependencias limpiadas
Se liberÃ³ espacio eliminando node_modules/
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**QuÃ© hace:**
- Elimina completamente el directorio `docs/node_modules`
- Libera espacio en disco
- Ãštil para resolver problemas de dependencias

**CuÃ¡ndo usarlo:**
- Problemas con dependencias corruptas o conflictivas
- Liberar espacio en disco
- Antes de reinstalar dependencias desde cero
- Resolver errores extraÃ±os de npm

**Flujo tÃ­pico de resoluciÃ³n de problemas:**
```bash
make docs-clean      # Limpiar dependencias
make docs-install    # Reinstalar desde cero
make docs-dev        # Probar que funciona
```

---

<a id="cmd-diff-tools"></a>
### ğŸ“Š Diff Tools

#### `make diff-flake`
Muestra cambios en flake.nix y flake.lock.

```bash
make diff-flake
# Ãštil despuÃ©s de updates para ver quÃ© cambiÃ³
```


<a id="cmd-build-analysis"></a>
### ğŸ” Build Analysis

#### `make closure-size`
Muestra el tamaÃ±o del closure del sistema y los 10 paquetes mÃ¡s grandes.

```bash
make closure-size
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#           ğŸ“Š System Closure Size Analysis          
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# Total system closure size:
#   40.1 GiB
#   /nix/store/...-nixos-system-hydenix-26.05...
# 
# Top 10 largest packages:
#   1006.7 MiB  /nix/store/...-ffmpeg-6.1.3-bin
#   1008.3 MiB  /nix/store/...-security-wrapper-gamescope...
#   ...
# 
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âœ… Analysis complete
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Ãštil para:**
- Identificar quÃ© consume mÃ¡s espacio en el sistema
- Optimizar el closure del sistema
- Decidir quÃ© paquetes desinstalar o reemplazar
- Planear limpiezas de espacio en disco

**CuÃ¡ndo usarlo:**
- Antes de hacer limpieza del sistema
- Cuando el disco se estÃ¡ llenando
- Para entender el tamaÃ±o real del sistema
- Para comparar tamaÃ±os entre generaciones

---

<a id="cmd-quick-fixes"></a>
### ğŸ› ï¸ Quick Fixes

#### `make fix-permissions`
Corrige problemas comunes de permisos en `~/.config` y `~/.local`.

```bash
make fix-permissions
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#           ğŸ”§ Fix Permissions                        
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# Fixing common permission issues...
# This requires sudo privileges.
# 
# 1. Fixing ~/.config permissions... âœ“
# 2. Fixing ~/.local permissions... âœ“
# 3. Fixing git repository permissions...
#   âœ“ Git permissions OK
# 
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âœ… Permissions fixed
# Common permission issues have been resolved.
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**CuÃ¡ndo usarlo:**
- DespuÃ©s de errores de "permission denied"
- Problemas con aplicaciones que no pueden escribir configs
- DespuÃ©s de cambiar de usuario
- DespuÃ©s de ejecutar comandos con `sudo` que afectan permisos

**QuÃ© hace:**
- Corrige ownership de `~/.config` y `~/.local`
- Corrige permisos del repositorio git automÃ¡ticamente
- Muestra progreso paso a paso

**Nota:** Este comando se ejecuta automÃ¡ticamente en `make switch` para prevenir problemas de permisos.

---

#### `make fix-git-permissions`
Corrige permisos de ownership dentro del repositorio git del flake.

```bash
make fix-git-permissions
#   âœ“ Git permissions OK
# o
#   Fixing ownership in /home/user/Dotfiles/.git... âœ“
```

**CuÃ¡ndo usarlo:**
- Si `git` falla por permisos despuÃ©s de ejecutar comandos con `sudo`
- Cuando git muestra errores de "permission denied"
- DespuÃ©s de usar `sudo` en comandos que tocan el repositorio

**QuÃ© hace:**
- Verifica si hay problemas de ownership en `.git/objects`
- Solo corrige si es necesario (no hace cambios si todo estÃ¡ bien)
- Maneja el caso cuando no hay repositorio git

**Nota:** Este comando se ejecuta automÃ¡ticamente en `make fix-permissions` y `make switch`.

---

#### `make fix-store`
Intenta reparar problemas en el Nix store verificando y reparando corrupciÃ³n.

```bash
make fix-store
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#           ğŸ”§ Repair Nix Store                       
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# Verifying and repairing Nix store...
# âš ï¸  This may take a long time (minutes to hours) on large systems.
# The store will be checked for corruption and repaired if needed.
# 
# [verification output...]
# 
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âœ… Store repair complete
# All store paths verified and repaired.
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**CuÃ¡ndo usarlo:**
- Errores de "hash mismatch" al compilar o usar paquetes
- CorrupciÃ³n del store detectada
- DespuÃ©s de apagones o crashes del sistema
- Problemas extraÃ±os al compilar que no tienen otra explicaciÃ³n
- Cuando `nix-store --verify` reporta problemas

**âš ï¸ Advertencia importante:**
- Puede tardar **mucho tiempo** (minutos a horas) en sistemas grandes
- Verifica cada path en el store, lo cual es muy lento
- Solo Ãºsalo cuando realmente tengas problemas, no como mantenimiento rutinario

**QuÃ© hace:**
- Verifica la integridad de todos los paths en el store
- Repara automÃ¡ticamente cualquier corrupciÃ³n encontrada
- Descarga paths corruptos nuevamente si es necesario

---

<a id="cmd-utilities"></a>
### ğŸ”§ Utilidades

#### `make tree`
Muestra la estructura de directorios de tu configuraciÃ³n usando `eza` (con iconos) o `tree` como fallback.

```bash
make tree
```

**Output ejemplo:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ğŸ“ Configuration Structure                 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

hosts
â”œâ”€â”€ default.nix
â”œâ”€â”€ hydenix
â”‚   â”œâ”€â”€ configuration.nix
â”‚   â””â”€â”€ user.nix
â”œâ”€â”€ laptop
â”‚   â”œâ”€â”€ configuration.nix
â”‚   â”œâ”€â”€ hardware-configuration.nix
â”‚   â””â”€â”€ user.nix
â””â”€â”€ vm
    â”œâ”€â”€ configuration.nix
    â”œâ”€â”€ hardware-configuration.nix
    â””â”€â”€ user.nix
modules
â”œâ”€â”€ hm
â”‚   â”œâ”€â”€ nvim
â”‚   â”œâ”€â”€ programs
â”‚   â””â”€â”€ ...
â””â”€â”€ system
    â””â”€â”€ ...
resources
â”œâ”€â”€ config
â”œâ”€â”€ scripts
â””â”€â”€ ...
```

**Â¿Para quÃ© sirve?**

1. **Visualizar estructura del proyecto:** Ver rÃ¡pidamente cÃ³mo estÃ¡ organizada tu configuraciÃ³n de NixOS sin tener que navegar manualmente por los directorios.

2. **Entender la organizaciÃ³n:** Especialmente Ãºtil cuando trabajas con mÃºltiples hosts, mÃ³dulos complejos, o cuando vuelves a un proyecto despuÃ©s de tiempo.

3. **NavegaciÃ³n rÃ¡pida:** Te ayuda a encontrar dÃ³nde estÃ¡n ubicados los archivos de configuraciÃ³n especÃ­ficos (hosts, mÃ³dulos de Home Manager, recursos, etc.).

4. **DocumentaciÃ³n visual:** Ãštil para compartir la estructura del proyecto con otros o para documentar cÃ³mo estÃ¡ organizado tu repositorio.

**CaracterÃ­sticas:**
- Usa `eza --tree` con iconos si estÃ¡ disponible (mÃ¡s moderno y visual)
- Fallback a `tree` si `eza` no estÃ¡ instalado
- Muestra solo directorios relevantes: `hosts/`, `modules/`, `resources/`
- Filtra automÃ¡ticamente: `.git`, `result`, `node_modules`, `*.tar.gz`
- Nivel de profundidad limitado a 3 para mantener la salida legible

**CuÃ¡ndo usarlo:**
- Al explorar el proyecto por primera vez
- Cuando necesitas encontrar dÃ³nde estÃ¡ un archivo de configuraciÃ³n especÃ­fico
- Para entender la estructura antes de hacer cambios
- Como referencia rÃ¡pida de la organizaciÃ³n del proyecto

---


<a id="flujos-trabajo"></a>
## Flujos de Trabajo Comunes

**Mini Ã­ndice de flujos:**
- [Flujo de Trabajo Recomendado](#flujo-recomendado)
- [Flujo Diario BÃ¡sico](#flujo-diario)
- [Flujo Semanal de Mantenimiento](#flujo-semanal)
- [Flujo de ExperimentaciÃ³n](#flujo-experimentacion)
- [Flujo de Debugging](#flujo-debugging)
- [Flujo de InstalaciÃ³n de Software](#flujo-instalacion)
- [Flujo de ContribuciÃ³n Git](#flujo-contribucion)
- [Flujo de RecuperaciÃ³n de Desastres](#flujo-recuperacion)

<a id="flujo-recomendado"></a>
### ğŸ¯ Flujo de Trabajo Recomendado (NUEVO)

Elige el flujo segÃºn el tipo de cambio que estÃ¡s haciendo:

#### **Desarrollo Iterativo** (cambios frecuentes y pequeÃ±os)

Para cuando estÃ¡s probando cosas y haciendo cambios rÃ¡pidos:

```bash
# 1. Hacer cambios
nano modules/hm/hydenix-config.nix

# 2. Validar (rÃ¡pido, sin aplicar)
make validate

# 3. Si pasa, aplicar
make switch

# 4. Si falla algo, rollback
make rollback
```

**Ventajas:**
- âš¡ RÃ¡pido (validate es mÃ¡s rÃ¡pido que safe-switch)
- ğŸ” Ves exactamente quÃ© validaciÃ³n falla
- ğŸ¯ Separas validaciÃ³n de aplicaciÃ³n

**CuÃ¡ndo usarlo:**
- Cambios de configuraciÃ³n pequeÃ±os
- Ajustes de valores
- IteraciÃ³n rÃ¡pida durante desarrollo

---

#### **Cambios Importantes** (mÃ¡s seguro)

Para cambios que requieren mÃ¡s cuidado:

```bash
# 1. Hacer cambios
nano modules/hm/programs/development/nix-tools.nix

# 2. Validar + aplicar en un solo paso
make safe-switch

# 3. Listo! (o rollback si algo falla)
```

**Ventajas:**
- ğŸ›¡ï¸ MÃ¡s seguro (valida antes de aplicar automÃ¡ticamente)
- ğŸ¯ Todo-en-uno (un solo comando)
- âœ… No aplica si hay errores

**CuÃ¡ndo usarlo:**
- MÃ³dulos nuevos completos
- Cambios en mÃºltiples archivos
- Imports nuevos
- DespuÃ©s de updates
- Cuando no estÃ¡s 100% seguro

---

#### **Testing Antes de ProducciÃ³n**

Para experimentar sin riesgo:

```bash
# 1. Test temporal (no persiste al reboot)
make test

# 2. Si funciona bien, hacer permanente
make safe-switch
```

**Ventajas:**
- ğŸ”¬ ExperimentaciÃ³n sin riesgo
- ğŸ”„ Los cambios se revierten al reiniciar
- âœ… Pruebas en ambiente "real" pero temporal

**CuÃ¡ndo usarlo:**
- Configuraciones experimentales
- Probar software nuevo
- Verificar compatibilidad
- Antes de commits importantes

---

<a id="flujo-diario"></a>
### ğŸ“… Flujo Diario BÃ¡sico

```bash
# 1. Haces cambios en configuraciÃ³n
nvim modules/hm/programs/terminal/fish.nix

# 2. Aplicas
make switch

# 3. Si hay problemas
make rollback
```

---

<a id="flujo-semanal"></a>
### ğŸ“… Flujo Semanal de Mantenimiento

```bash
# Lunes por la maÃ±ana:
make update              # Actualizar inputs
make dry-run             # Ver quÃ© cambiarÃ­a
make test                # Probar
make switch              # Aplicar si todo bien
make clean               # Limpiar
make info                # Verificar estado
```

---

<a id="flujo-experimentacion"></a>
### ğŸ”¬ Flujo de ExperimentaciÃ³n

```bash
# Probar algo nuevo sin riesgo:
make test                # Solo para esta sesiÃ³n
# Prueba tu cambio
# Si te gusta:
make switch              # Aplica permanentemente
# Si no te gusta:
# Simplemente reinicia (cambios se pierden)
```

---

<a id="flujo-debugging"></a>
### ğŸ› Flujo de Debugging

```bash
# Algo no funciona:
make debug               # Rebuild con verbose
make watch-logs          # En otra terminal
# Revisa errores
make rollback            # Si es grave
make repl                # Explorar configuraciÃ³n
```

---

<a id="flujo-instalacion"></a>
### ğŸ“¦ Flujo de InstalaciÃ³n de Software

```bash
# Quieres instalar algo nuevo:
make update              # Asegura Ãºltimas versiones
# Edita tu config para agregar el paquete
nvim modules/hm/default.nix
make dry-run             # Ve quÃ© se instalarÃ¡
make switch              # Aplica

# Si el paquete no existe en cache:
# Puede tardar (compilaciÃ³n)
```

---

<a id="flujo-contribucion"></a>
### ğŸŒ Flujo de ContribuciÃ³n Git

```bash
# Cambios listos para compartir:
git add .
git commit -m "feat: add neovim config"
make test                # Verifica que funciona
git push
# Opcional: crear PR
gh pr create
```

---

<a id="flujo-recuperacion"></a>
### ğŸ’¾ Flujo de RecuperaciÃ³n de Desastres

```bash
# Sistema totalmente roto:
make rollback            # Intenta volver atrÃ¡s

# Si rollback no funciona:
make list-generations    # Ve generaciones disponibles
# Reinicia y en GRUB elige generaciÃ³n anterior

# Si necesitas restaurar una versiÃ³n anterior:
make rollback            # Volver a generaciÃ³n anterior
# O usar git para restaurar archivos especÃ­ficos
```

---

<a id="resolucion-problemas"></a>
## ResoluciÃ³n de Problemas

**Mini Ã­ndice de problemas:**
- [cannot build derivation](#err-cannot-build)
- [file not found](#err-file-not-found)
- [not a flake](#err-not-a-flake)
- [flakes no habilitados](#err-flakes)
- [disk full](#err-disk-full)
- [permission denied](#err-permission-denied)
- [rebuild muy lento](#err-rebuild-lento)
- [cambios no se aplican](#err-no-aplican)

<a id="err-cannot-build"></a>
### âŒ Error: "cannot build derivation"

**SoluciÃ³n:**
```bash
make debug               # Ver error completo
# Suele ser error de sintaxis en .nix
make flake-check        # Valida sintaxis
```

**Causas comunes:**
- Falta `;` en Nix
- ParÃ©ntesis/corchetes sin cerrar
- Variable no definida

---

<a id="err-file-not-found"></a>
### âŒ Error: "file not found"

**SoluciÃ³n:**
```bash
# AsegÃºrate de estar en directorio correcto
cd ~/dotfiles
make switch

# Verifica que flake.nix existe
ls flake.nix
```

---

<a id="err-not-a-flake"></a>
### âŒ Error: "not a flake"

**SoluciÃ³n:**
```bash
# Asegura que tienes flake.nix vÃ¡lido
nix flake show .

# Re-agrega a git si es nuevo archivo
git add flake.nix
```

---

<a id="err-flakes"></a>
### âŒ Error: "experimental feature 'flakes' not enabled"

Tu NixOS ya tiene flakes habilitados (en tu config), pero si ves esto:

```bash
# Agregar a configuration.nix:
nix.settings.experimental-features = [ "nix-command" "flakes" ];
```

---

<a id="err-disk-full"></a>
### âŒ Error: "disk full"

```bash
make info                # Ver espacio usado
make clean               # Limpiar
make optimize            # Optimizar store
# Si es emergencia:
make deep-clean          # âš ï¸ Borra TODO
```

---

<a id="err-permission-denied"></a>
### âŒ Error: "permission denied"

**Causas:**
1. Comando necesita `sudo` (el Makefile lo maneja)
2. Archivo sin permisos

```bash
# Si es un mÃ³dulo nuevo:
chmod 644 modules/hm/programs/terminal/nuevo.nix
```

---

<a id="err-rebuild-lento"></a>
### âŒ Rebuild muy lento

**Causas y soluciones:**
1. **Primera build:** siempre es lenta, paciencia
2. **CompilaciÃ³n:** algunos paquetes compilan
   ```bash
   # Ver quÃ© compila:
   make dry-run
   ```
3. **Muchas dependencies:**
   ```bash
   # Usa binary cache
   # Ya configurado en tu sistema
   ```

---

<a id="err-no-aplican"></a>
### âŒ Cambios no se aplican

```bash
# Verifica que guardaste el archivo
# Verifica que estÃ¡s editando el archivo correcto
make debug               # Ve quÃ© mÃ³dulos se cargan
```

---

<a id="tips-trucos"></a>
## Tips y Trucos

**Mini Ã­ndice de tips:**
- [Tip 1: Alias](#tip-1)
- [Tip 2: Testing rÃ¡pido](#tip-2)
- [Tip 3: Ver cambios de update](#tip-3)
- [Tip 4: BÃºsqueda de paquetes](#tip-4)
- [Tip 5: EdiciÃ³n rÃ¡pida](#tip-5)
- [Tip 6: Commits descriptivos](#tip-6)
- [Tip 7: Backup automÃ¡tico](#tip-7)
- [Tip 8: TamaÃ±o de paquetes](#tip-8)
- [Tip 9: Testing en VM](#tip-9)
- [Tip 10: Documentar cambios](#tip-10)

<a id="tip-1"></a>
### ğŸ’¡ Tip 1: Alias en Fish/Bash

Agrega a tu shell config:

```bash
# Fish (~/.config/fish/config.fish)
alias ns="make switch"
alias nt="make test"
alias nr="make rollback"
alias nu="make update"

# Bash/Zsh (~/.bashrc o ~/.zshrc)
alias ns='make switch'
alias nt='make test'
```

---

<a id="tip-2"></a>
### ğŸ’¡ Tip 2: Testing RÃ¡pido

```bash
# Antes de commit:
make flake-check && make dry-run
# Si ambos pasan, es seguro hacer switch
```

---

<a id="tip-3"></a>
### ğŸ’¡ Tip 3: Ver Cambios de Update

```bash
# Antes de update:
nix flake metadata > before.txt

make update

nix flake metadata > after.txt
diff before.txt after.txt
```

---

<a id="tip-4"></a>
### ğŸ’¡ Tip 4: BÃºsqueda de Paquetes

```bash
# Buscar paquete:
nix search nixpkgs neovim

# Ver versiÃ³n actual:
nix eval .#nixosConfigurations.hydenix.pkgs.neovim.version
```

---

<a id="tip-5"></a>
### ğŸ’¡ Tip 5: EdiciÃ³n RÃ¡pida

Crea aliases para tus archivos mÃ¡s editados:

```bash
alias edit-fish="nvim ~/dotfiles/modules/hm/programs/terminal/fish.nix"
alias edit-hypr="nvim ~/dotfiles/modules/hm/programs/hyprland.nix"
alias edit-flake="nvim ~/dotfiles/flake.nix"
```

---

<a id="tip-6"></a>
### ğŸ’¡ Tip 6: Commits Descriptivos

En lugar de `make save`, usa commits descriptivos:

```bash
# Malo (make save hace esto):
git commit -m "config: update 2026-01-11 14:30:45"

# Bueno:
git commit -m "feat: add kitty terminal with custom theme"
git commit -m "fix: resolve fish shell completion issue"
git commit -m "refactor: organize browser configs"
```

**Convenciones:**
- `feat:` - nueva funcionalidad
- `fix:` - correcciÃ³n
- `refactor:` - reorganizaciÃ³n
- `docs:` - documentaciÃ³n
- `style:` - formateo

---

<a id="tip-7"></a>
### ğŸ’¡ Tip 7: Backup AutomÃ¡tico

Crea un cronjob o systemd timer:

```bash
# Backup semanal automÃ¡tico
# Agregar a crontab: crontab -e
0 2 * * 1 cd ~/dotfiles && git add . && git commit -m "Weekly backup" && git push
```

---

<a id="tip-8"></a>
### ğŸ’¡ Tip 8: Ver TamaÃ±o de Paquetes

```bash
# Ver quÃ© consume mÃ¡s espacio:
nix path-info -Sh /run/current-system | sort -k2 -h
```

---

<a id="tip-9"></a>
### ğŸ’¡ Tip 9: Testing en VM RÃ¡pido

```bash
# En lugar de arriesgar tu sistema:
make vm
# Prueba cambios en VM
# Si funciona, aplica en sistema real
```

---

<a id="tip-10"></a>
### ğŸ’¡ Tip 10: Documentar tus Cambios

MantÃ©n un changelog personal:

```bash
# Crear CHANGELOG.md
echo "## $(date +%Y-%m-%d) - ConfiguraciÃ³n inicial kitty" >> CHANGELOG.md
```

---

## ğŸ“š Recursos Adicionales

### DocumentaciÃ³n Oficial
- **NixOS Manual:** https://nixos.org/manual/nixos/stable/
- **Nix Language:** https://nixos.org/manual/nix/stable/language/
- **Home Manager:** https://nix-community.github.io/home-manager/

### Tu ConfiguraciÃ³n
- `README.md` - Overview de tu config
- `AGENTS.md` - Estado de migraciÃ³n
- `docs/` - DocumentaciÃ³n adicional

### Comandos de Referencia RÃ¡pida

```bash
# Sistema de Ayuda
make help              # Lista de todos los comandos
make help-examples     # Comandos con ejemplos de uso â­
make help            # Workflows completos

# Uso Diario
make switch            # Aplicar cambios
make test              # Probar sin aplicar
make rollback          # Deshacer Ãºltimo cambio

# InformaciÃ³n
  make git-status        # Estado completo del repositorio y sistema
  make status            # Alias de git-status
make health            # Health check

# Mantenimiento
make update            # Actualizar paquetes
make clean             # Limpiar espacio
make optimize          # Optimizar store
```

---

## ğŸ¯ PrÃ³ximos Pasos

1. **Lee el README.md** de tu configuraciÃ³n
2. **Experimenta** con `make test` (es seguro)
3. **Usa Git** para versionar cambios importantes
4. **Usa rollback** sin miedo si algo falla
5. **Documenta** tus cambios importantes
6. **MantÃ©n actualizado** con `make update` semanal
7. **Limpia regularmente** con `make clean`

---

## ğŸ¤ Contribuciones

Â¿Encontraste un truco Ãºtil? Â¡AgrÃ©galo aquÃ­!

```bash
# Edita este tutorial
nvim MAKEFILE_TUTORIAL.md

# Comparte con la comunidad
git add MAKEFILE_TUTORIAL.md
git commit -m "docs: add [tu truco] to tutorial"
git push
```

---

**Â¡Disfruta tu configuraciÃ³n NixOS con Hydenix!** ğŸ‰

Si tienes preguntas, revisa:
1. Este tutorial
2. `make help`
3. `docs/faq.md`
4. Comunidad de Hydenix

---

### Correcciones Implementadas

Los siguientes comandos fueron corregidos en esta actualizaciÃ³n:

1. **`make deep-clean`** - Ahora pide confirmaciÃ³n correctamente
2. **`make format`** - Detecta quÃ© formatter tienes instalado (nixpkgs-fmt o alejandra)
3. **`make lint`** - Detecta si statix estÃ¡ instalado y da instrucciones claras
4. **`make vm`** - Corregido para usar `nix build .#vm` (coincide con flake.nix)
5. **`make hardware-scan`** - Genera archivo en `hosts/$(HOSTNAME)/` en lugar del root

---

### Git Status Mejorado

Los comandos `make git-status` y `make status` (alias) ahora muestran informaciÃ³n completa y organizada:

```bash
make git-status
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#            ğŸ“Š Repository Status                    
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# ğŸ“ Configuration
# â”œâ”€ Host: hydenix
# â”œâ”€ Flake: /home/ludus/Dotfiles
# â””â”€ NixOS: 26.05.20251229.95e96e8
#
# ğŸ“¦ Git Status
# â”œâ”€ Repository: 25ASAB015/nix-dotfiles
# â”œâ”€ Branch: main
# â”œâ”€ Status: Uncommitted changes
#
# Local changes:
# M Makefile
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#             ğŸ“ Recent Changes                      
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
#  241fd57   feat: improve changelog output format...    4 minutes ago
#  de95dff   refactor: remove make packages command...   11 minutes ago
#  a9a8e70   feat: combine list-hosts and hosts-info...  15 minutes ago
```

**Nota:** La informaciÃ³n de System Info (Store size, Generations, Disk usage) ahora se muestra en `make info` en lugar de `make status`.

---

### ğŸ’¡ Flujos de Trabajo Nuevos

**Flujo de ValidaciÃ³n Segura:**
```bash
make validate       # Chequea sintaxis y config
make test           # Prueba temporalmente  
make safe-switch    # Valida y aplica
```

**Flujo de Health Check:**
```bash
make health         # Ver estado general
make generation-sizes  # Ver uso de espacio
make clean-week     # Limpiar si es necesario
```

**Flujo Multi-Host:**
```bash
make list-hosts     # Ver hosts disponibles
make validate HOSTNAME=laptop  # Validar config de laptop
make switch HOSTNAME=laptop    # Aplicar a laptop
```

---
<a id="nuevos-flujos"></a>
## ğŸ¯ Nuevos Flujos de Trabajo

**Mini Ã­ndice de flujos:**
- [DocumentaciÃ³n](#flujo-docs)
- [Logs y Debugging](#flujo-logs)
- [Git Log y Versiones](#flujo-git-log)
- [CreaciÃ³n de Nuevo Host](#flujo-nuevo-host)
- [Desarrollo de MÃ³dulos](#flujo-modulos)
- [ComparaciÃ³n](#flujo-comparacion)
- [Build Analysis](#flujo-build-analysis)
- [Troubleshooting Avanzado](#flujo-troubleshooting)
- [OptimizaciÃ³n de Espacio](#flujo-optimizar)

<a id="flujo-docs"></a>
### Flujo de DocumentaciÃ³n

#### Desarrollo de DocumentaciÃ³n

```bash
# 1. Iniciar servidor de desarrollo (instala deps automÃ¡ticamente)
make docs-dev

# 2. Editar archivos en docs/src/content/docs/
# Los cambios se reflejan automÃ¡ticamente en http://localhost:4321

# 3. Construir para producciÃ³n
make docs-build
```

#### Actualizar DocumentaciÃ³n despuÃ©s de Cambios en Makefile

```bash
# 1. Hacer cambios en el Makefile
nvim Makefile

# 2. Actualizar la documentaciÃ³n correspondiente
nvim docs/src/content/docs/makefile.mdx

# 3. Previsualizar cambios
make docs-dev

# 4. Verificar que el build funciona
make docs-build
```

#### Resolver Problemas de Dependencias

```bash
# Si hay errores con npm o dependencias:
make docs-clean      # Limpiar node_modules
make docs-install    # Reinstalar dependencias
make docs-dev        # Probar que funciona
```

#### Ver DocumentaciÃ³n Local

```bash
# Ver quÃ© documentaciÃ³n tienes (archivos markdown locales)
make docs-local

# Ver documentaciÃ³n web interactiva
make docs-dev
```

---

<a id="flujo-logs"></a>
### Flujo de Logs y Debugging

```bash
# Ver errores recientes
make logs-errors

# Ver logs de boot
make logs-boot

# Ver logs de un servicio especÃ­fico
make logs-service SVC=docker
```

---


<a id="flujo-git-log"></a>
### Flujo de Git Log y Versiones

```bash
# Ver quÃ© has cambiado recientemente
make git-log

# Ver versiÃ³n actual del sistema
  make info

# Ver detalles de generaciÃ³n actual
make current-generation

# Ver todos los hosts configurados
make hosts-info
```

---


<a id="flujo-comparacion"></a>
### Flujo de ComparaciÃ³n

```bash
# Comparar configuraciones de diferentes hosts

# Ver diferencias en archivos .nix
make git-diff

# Ver cambios en flake despuÃ©s de update
make update
make diff-flake
```

---

<a id="flujo-build-analysis"></a>
### Flujo de Build Analysis

```bash
# Â¿Por quÃ© tengo este paquete instalado?
# Â¿QuÃ© consume mÃ¡s espacio?
make closure-size

# Optimizar basado en resultados
make clean
```

---

<a id="flujo-troubleshooting"></a>
### Flujo de Troubleshooting Avanzado

```bash
# Problemas de permisos
make fix-permissions

# DiagnÃ³stico de red completo
make test-network

# Errores extraÃ±os en el store
make fix-store

# Ver errores del sistema
make logs-errors

# Ver logs de boot si hay problemas al iniciar
make logs-boot

# Verificar salud general
make health
```

---

<a id="flujo-optimizar"></a>
### Flujo de OptimizaciÃ³n de Espacio

```bash
# 1. Ver quÃ© ocupa mÃ¡s espacio
make closure-size

# 2. Ver tamaÃ±o de generaciones
make generation-sizes

# 3. Limpiar generaciones antiguas
make clean-week

# 4. Optimizar el store
make optimize

# 5. Verificar resultado
make info
```

---

<a id="resumen-comandos"></a>
## ğŸ“Š Resumen: Todos los Comandos Disponibles

## ğŸ§­ Mapa rÃ¡pido por Ã¡reas

Este mapa ofrece una visiÃ³n compacta de comandos por dominio. Ãšsalo como acceso rÃ¡pido antes de ir al detalle.

### Ayuda y DocumentaciÃ³n (7)
`help`, `help-examples`, `docs-local`, `docs-dev`, `docs-build`, `docs-install`, `docs-clean`

### GestiÃ³n del Sistema (Rebuild/Switch) (10)
`switch`, `safe-switch`, `test`, `build`, `dry-run`, `boot`, `validate`, `debug`, `quick`, `emergency`

### Limpieza y OptimizaciÃ³n (7)
`clean`, `clean-week`, `clean-conservative`, `deep-clean`, `optimize`, `clean-result`, `fix-store`

### Actualizaciones y Flakes (8)
`update`, `update-nixpkgs`, `update-hydenix`, `update-input`, `flake-diff`, `upgrade`, `show`, `flake-check`

### Generaciones y Rollback (6)
`list-generations`, `rollback`, `diff-generations`, `diff-gen`, `generation-sizes`, `current-generation`

### Git y Respaldo (7)
`git-add`, `git-commit`, `git-push`, `git-status`, `git-diff`, `sync`, `git-log`

### DiagnÃ³stico y Logs (8)
`health`, `test-network`, `info`, `status`, `watch-logs`, `logs-boot`, `logs-errors`, `logs-service`

### AnÃ¡lisis y Desarrollo (11)
`list-hosts`, `hosts-info`, `search`, `search-installed`, `repl`, `shell`, `vm`, `closure-size`

### Formato, Linting y Estructura (4)
`format`, `lint`, `tree`

### Reportes y ExportaciÃ³n (1)
`git-log`

### Plantillas y Otros (4)
`hardware-scan`, `fix-permissions`, `fix-git-permissions`

**Total: 69 comandos disponibles** ğŸ‰

---

## ğŸ† ImplementaciÃ³n Completa Finalizada

Todas las mejoras planificadas han sido implementadas exitosamente:
- âœ… **FASE 1:** 5 correcciones crÃ­ticas
- âœ… **FASE 2:** 8 mejoras importantes  
- âœ… **FASE 3:** 14 ampliaciones seleccionadas
- âœ… **Build Analysis:** 1 comando (closure-size)
- âœ… **Quick Fixes:** 2 comandos (fix-permissions, fix-store)
- âœ… **Help System:** Sistema de ayuda hÃ­brido en 3 niveles â­ NUEVO

**Total implementado: 32+ mejoras**

---

<a id="sistema-ayuda-hibrido"></a>
## ğŸ¯ Sistema de Ayuda HÃ­brido (Tres Niveles)

Tu Makefile ahora incluye un **sistema de ayuda profesional** con tres niveles:

1. **`make help`** - Referencia rÃ¡pida de todos los comandos
2. **`make help-examples`** â­ - Ejemplos de uso con parÃ¡metros
3. **`make help`** - Workflows y mejores prÃ¡cticas

Esto te permite encontrar informaciÃ³n de diferentes formas segÃºn tu necesidad:
- **Â¿QuÃ© hay disponible?** â†’ `make help`
- **Â¿CÃ³mo lo uso?** â†’ `make help-examples`
- **Â¿CÃ³mo combino comandos?** â†’ `make help`

---

*Ãšltima actualizaciÃ³n: 2026-01-19*  
*VersiÃ³n: 5.2 - Comandos de DocumentaciÃ³n Mejorados*  
*Total de comandos: 69*  
*Sistema de ayuda: 2 niveles (help, help-examples)*
*Fases completadas: 100% (FASE 1, 2, 3 + extras + docs)*  
*Mantenedor: ludus*  
*Nuevos comandos: docs-dev, docs-build, docs-install, docs-clean (con instalaciÃ³n automÃ¡tica)*

