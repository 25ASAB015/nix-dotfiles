---
title: AI Assistants
description: Configuraci칩n de asistentes de IA, especialmente OpenCode
---

# 游뱄 AI Assistants

Este sistema incluye **OpenCode**, un asistente de IA para terminal que permite interactuar con m칰ltiples modelos de IA (Claude, Gemini, GPT, etc.) directamente desde la terminal.

## OpenCode

**OpenCode** es una herramienta de l칤nea de comandos que permite interactuar con modelos de IA directamente desde la terminal. Incluye integraci칩n con LSP para autocompletado inteligente, skills personalizables y soporte para MCP (Model Context Protocol) servers.

### Configuraci칩n

La configuraci칩n de OpenCode se encuentra en:
```
modules/hm/programs/ai-assistants/opencode/
```

### Uso B치sico

```bash
# Iniciar el asistente en modo interactivo
opencode

# Enviar un prompt directo
opencode "explica qu칠 es Nix"

# Usar con un archivo
opencode < archivo.txt
```

### Caracter칤sticas Principales

- **M칰ltiples proveedores de IA**: Soporte para Google, OpenRouter, Anthropic, y m치s
- **Integraci칩n con LSP**: Autocompletado inteligente usando Language Servers
- **Skills personalizables**: Habilidades especializadas para tareas espec칤ficas
- **MCP Servers**: Extensi칩n de capacidades mediante Model Context Protocol
- **Formatters integrados**: Formateo autom치tico de c칩digo
- **Plugin Antigravity**: Acceso gratuito a modelos premium

---

## Modelos de IA (Providers)

OpenCode est치 configurado con m칰ltiples modelos de IA a trav칠s del plugin **antigravity-auth**, que proporciona acceso gratuito a modelos premium.

### Modelos Disponibles

#### Google Gemini

- **Gemini 3 Pro Low**: Modelo principal de Google (1M tokens contexto, 65K salida)
- **Gemini 3 Pro High**: Versi칩n de mayor capacidad
- **Gemini 3 Flash**: Respuestas m치s r치pidas (1M tokens contexto, 64K salida)

Todos los modelos Gemini soportan:
- Entrada: texto, im치genes, PDFs
- Salida: texto

#### Claude (Anthropic)

- **Claude Sonnet 4.5**: Equilibrio entre velocidad y capacidad (200K contexto, 64K salida)
  - Variantes con "thinking": Low, Medium, High (razonamiento extendido)
- **Claude Opus 4.5**: Modelo m치s capaz (200K contexto, 64K salida)
  - Variantes con "thinking": Low, Medium, High

Todos los modelos Claude soportan:
- Entrada: texto, im치genes, PDFs
- Salida: texto

#### GPT-OSS

- **GPT-OSS 120B Medium**: Alternativa open source (128K contexto, 32K salida)
  - Soporta: texto, im치genes, PDFs

### Configurar Modelos

Los modelos se configuran en `_providers.nix`. Para agregar un nuevo modelo:

```nix
"antigravity-nombre-modelo" = {
  name = "Nombre del Modelo (Antigravity)";
  limit = {
    context = 1048576;  # Tokens de contexto
    output = 65535;     # Tokens de salida
  };
  modalities = {
    input = ["text" "image" "pdf"];
    output = ["text"];
  };
};
```

### Proveedores Habilitados

Actualmente habilitados:
- **openrouter**: Acceso a m칰ltiples modelos a trav칠s de OpenRouter
- **google**: Modelos de Google (Gemini)

### Proveedores Deshabilitados

Por defecto, muchos proveedores est치n deshabilitados para simplificar la configuraci칩n. Puedes habilitarlos en `hydenix-config.nix`:

```nix
modules.terminal.software.opencode = {
  enabledProviders = ["openrouter" "google" "anthropic"];
  disabledProviders = [];  # Vaciar para habilitar todos
};
```

---

## Skills (Habilidades)

Los **skills** son archivos `SKILL.md` que proporcionan instrucciones especializadas al modelo de IA para tareas espec칤ficas. Se descargan de repositorios p칰blicos de GitHub.

### Skills Instalados

1. **technical-writing**: Escritura t칠cnica profesional
2. **refactoring-patterns**: Patrones de refactoring de c칩digo
3. **blog-post-writer**: Escritor de posts de blog
4. **frontend-design**: Dise침o frontend
5. **architecture-patterns**: Patrones de arquitectura de software
6. **flutter-development**: Desarrollo Flutter
7. **writing-documentation**: Escritura de documentaci칩n
8. **rust-engineer**: Ingenier칤a en Rust

### Agregar un Nuevo Skill

Para agregar un skill, edita `_skills.nix`:

```nix
skills = {
  # Tu nuevo skill
  mi-skill = fetchSkill {
    name = "mi-skill";
    owner = "usuario-github";
    repo = "repositorio";
    rev = "commit-hash";
    path = "ruta/al/SKILL.md";
    hash = "sha256-hash-del-archivo";
  };
};
```

O para un skill con m칰ltiples archivos:

```nix
mi-skill-dir = fetchSkillDir {
  name = "mi-skill-dir";
  owner = "usuario-github";
  repo = "repositorio";
  rev = "commit-hash";
  basePath = "ruta/al/directorio";
  hash = "sha256-hash";
};
```

Los skills se instalan en `~/.config/opencode/skill/`.

---

## Language Servers (LSP)

OpenCode incluye integraci칩n con Language Servers para autocompletado inteligente y an치lisis de c칩digo.

### LSPs Configurados

- **nil**: LSP para Nix (archivos `.nix`)
- **biome**: LSP para JavaScript/TypeScript (archivos `.js`, `.ts`, `.json`, `.jsx`, `.tsx`)
- **marksman**: LSP para Markdown (archivos `.md`)
- **astro-ls**: LSP para Astro (archivos `.astro`)
- **tailwindcss**: LSP para Tailwind CSS (archivos `.css`, `.html`)
- **volar**: LSP para Vue.js (archivos `.vue`)

### Agregar un Nuevo LSP

Edita `_languages.nix`:

```nix
lspBins = {
  # Tu nuevo LSP
  mi-lsp = "${pkgs.mi-lsp}/bin/mi-lsp";
};

lsp = {
  mi-lsp = {
    command = [lspBins.mi-lsp "--stdio"];
    extensions = ["ext1" "ext2"];
  };
};
```

No olvides agregar el paquete a `packages`:

```nix
packages = with pkgs; [
  mi-lsp
  # ... otros paquetes
];
```

---

## Formatters

OpenCode incluye formatters autom치ticos para m칰ltiples lenguajes.

### Formatters Configurados

- **alejandra**: Formatter para Nix (archivos `.nix`)
- **biome**: Formatter para Astro (archivos `.astro`)
- **oxfmt**: Formatter multi-lenguaje (`.yaml`, `.js`, `.json`, `.jsx`, `.md`, `.ts`, `.tsx`, `.css`, `.html`, `.vue`)
- **shfmt**: Formatter para shell scripts (archivos `.sh`, `.bash`)

### Agregar un Nuevo Formatter

Edita `_languages.nix`:

```nix
formatterBins = {
  mi-formatter = "${pkgs.mi-formatter}/bin/mi-formatter";
};

formatter = {
  mi-formatter = {
    command = [formatterBins.mi-formatter "--opciones"];
    extensions = ["ext1" "ext2"];
  };
};
```

---

## MCP Servers (Model Context Protocol)

Los **MCP Servers** extienden las capacidades de OpenCode proporcionando contexto adicional y herramientas especializadas.

### MCP Servers Configurados

1. **gh_grep**: B칰squeda en GitHub
   - URL: `https://mcp.grep.app/`
   - Timeout: 10000ms

2. **deepwiki**: B칰squeda en DeepWiki
   - URL: `https://mcp.deepwiki.com/mcp`
   - Timeout: 10000ms

3. **context7**: Contexto adicional
   - URL: `https://mcp.context7.com/mcp`
   - Timeout: 10000ms

### Agregar un Nuevo MCP Server

En `hydenix-config.nix`:

```nix
modules.terminal.software.opencode = {
  mcp = {
    mi-mcp = {
      type = "remote";  # o "local"
      url = "https://mcp.example.com/";
      enabled = true;
      timeout = 10000;
    };
  };
};
```

Para servidores locales:

```nix
mi-mcp-local = {
  type = "local";
  url = "/ruta/al/servidor";
  enabled = true;
  timeout = 10000;
};
```

---

## Plugins

OpenCode soporta plugins para extender funcionalidad. El plugin principal configurado es:

### antigravity-auth

- **Versi칩n**: `1.2.7-beta.6`
- **Funci칩n**: Proporciona acceso gratuito a modelos premium a trav칠s de Google y OpenRouter
- **Ubicaci칩n**: `~/.config/opencode/node_modules/@opencode-ai/plugin`

### Agregar un Nuevo Plugin

En `hydenix-config.nix`:

```nix
modules.terminal.software.opencode = {
  plugins = [
    "opencode-antigravity-auth@1.2.7-beta.6"
    "otro-plugin@version"
  ];
};
```

---

## Configuraci칩n Avanzada

### Opciones Disponibles

Todas las opciones se configuran en `hydenix-config.nix`:

```nix
modules.terminal.software.opencode = {
  enable = true;                    # Habilitar OpenCode
  
  # Modelo peque침o para tareas r치pidas
  smallModel = "google/gemma-3n-e4b-it:free";
  
  # Actualizaciones autom치ticas
  autoupdate = false;
  
  # Compartir datos de uso
  share = "disabled";  # "enabled" o "disabled"
  
  # Proveedores
  enabledProviders = ["openrouter" "google"];
  disabledProviders = [ /* lista de proveedores */ ];
  
  # Plugins
  plugins = ["opencode-antigravity-auth@1.2.7-beta.6"];
  
  # MCP Servers
  mcp = { /* configuraci칩n de MCP */ };
};
```

### Archivo de Configuraci칩n

La configuraci칩n se genera en `~/.config/opencode/config.json` y incluye:
- Plugins instalados
- Modelo peque침o por defecto
- Configuraci칩n de actualizaciones
- Proveedores habilitados/deshabilitados
- Servidores MCP
- Formatters y LSPs
- Configuraci칩n de providers

### Variables de Entorno

OpenCode usa las siguientes variables:
- `OPENCODE_LIBC`: Path a libc (configurado autom치ticamente)
- `PATH`: Incluye todos los formatters y LSPs configurados

---

## Integraci칩n con Neovim

OpenCode tambi칠n est치 disponible como plugin de Neovim. Ver la documentaci칩n de Neovim para los keybindings:

- `<leader>aot`: Toggle opencode
- `<leader>aoA`: Ask opencode
- `<leader>aoa`: Ask about cursor/selection
- `<leader>aon`: New session
- `<leader>aoy`: Copy last response

---

## Aplicar Cambios

Despu칠s de modificar la configuraci칩n:

```bash
make switch
# o
home-manager switch
```

Luego reinicia OpenCode o inicia una nueva sesi칩n.

---

## Recursos

- **Documentaci칩n oficial**: https://github.com/anomalyco/opencode
- **Repositorio base**: https://github.com/linuxmobile/kaku
- **Plugin Antigravity**: Proporciona acceso gratuito a modelos premium

