---
title: Browsers
description: Configuraci√≥n de navegadores web instalados en el sistema
---

# üåê Browsers

Este sistema incluye m√∫ltiples navegadores web configurados. La configuraci√≥n se encuentra en:
```
modules/hm/programs/browsers/
```

## Navegadores instalados

El sistema incluye los siguientes navegadores:

1. **Zen Browser** - Navegador principal (fork de Firefox)
2. **Helium** - Navegador flotante basado en Chromium
3. **Google Chrome** - Navegador est√°ndar de Google

Todos los navegadores se importan desde `modules/hm/programs/browsers/default.nix`.

## Zen Browser

### Configuraci√≥n

La configuraci√≥n de Zen Browser se encuentra en:
```
modules/hm/programs/browsers/zen.nix
```

### Extensiones

Las extensiones se configuran en la secci√≥n `ExtensionSettings` dentro de `policies`. Actualmente est√°n instaladas:

- **uBlock Origin** - Bloqueador de anuncios
- **1Password X** - Gestor de contrase√±as

#### Agregar una nueva extensi√≥n

Para agregar una extensi√≥n:

1. Obt√©n el ID de la extensi√≥n desde [addons.mozilla.org](https://addons.mozilla.org)
   - Puede estar en formato `"ID@author"` o `"{UUID}"`
2. Usa la URL de descarga directa del .xpi:
   ```
   https://addons.mozilla.org/firefox/downloads/latest/[extension-slug]/latest.xpi
   ```
3. Agrega una entrada en `ExtensionSettings`:

```nix
ExtensionSettings = {
  "EXTENSION_ID" = {
    install_url = "https://addons.mozilla.org/firefox/downloads/latest/extension-slug/latest.xpi";
    installation_mode = "force_installed";
  };
};
```

**Ejemplo real:**
```nix
# 1Password X - Password Manager
"{d633138d-6c8b-4493-84d1-909800a9d5b5}" = {
  install_url = "https://addons.mozilla.org/firefox/downloads/latest/1password-x-password-manager/latest.xpi";
  installation_mode = "force_installed";
};
```

### Settings/Preferencias

Los settings personalizados se configuran en la secci√≥n `extraPrefs` usando sintaxis `user.js`.

#### Settings actualmente configurados

- **DRM Content**: Habilitado (`media.eme.enabled = true`)
- **Scrollbars siempre visibles**: Deshabilitado overlay scrollbars (`widget.gtk.overlay-scrollbars.enabled = false`)
- **Picture-in-Picture**: Habilitado con controles (`media.videocontrols.picture-in-picture.enabled = true`)
- **Mantener reproducci√≥n en PiP**: Al cambiar pesta√±as (`media.videocontrols.picture-in-picture.keep-playing-when-switching-tabs = true`)

#### Agregar un nuevo setting

Agrega l√≠neas en `extraPrefs` con el formato:

```nix
extraPrefs = ''
  user_pref("preference.name", value);
'';
```

**Ejemplos comunes:**
```nix
# Cambiar p√°gina de inicio
user_pref("browser.startup.homepage", "about:blank");

# Deshabilitar sugerencias de b√∫squeda
user_pref("browser.urlbar.showSearchSuggestionsFirst", false);

# Habilitar Wayland
user_pref("widget.wayland.enabled", true);

# Modo oscuro
user_pref("ui.systemUsesDarkTheme", 1);
```

Para ver todas las preferencias disponibles, abre Zen y ve a `about:config`.

### Keybindings

Los atajos de teclado personalizados se configuran en `profiles.default.keyboardShortcuts`.

#### Agregar un keybinding personalizado

1. Encuentra el ID del shortcut:
   - Abre Zen y ve a `about:config`
   - Busca `zen.keyboard.shortcuts.version` para ver la versi√≥n
   - O revisa `~/.zen/default/zen-keyboard-shortcuts.json` despu√©s de ejecutar Zen
2. Agrega una entrada en `keyboardShortcuts`:

```nix
profiles.default = {
  keyboardShortcuts = [
    {
      id = "cmd_shortcutName";  # ID del shortcut en Zen
      key = "t";                 # Car√°cter de la tecla (opcional)
      keycode = "VK_W";          # C√≥digo de tecla virtual (opcional)
      modifiers = {
        accel = true;    # Ctrl (Linux/Windows) o Cmd (macOS)
        control = true;  # Ctrl expl√≠cito
        alt = true;      # Alt
        shift = true;    # Shift
        meta = true;     # Meta/Windows/Command
      };
      disabled = false;  # true para deshabilitar el shortcut
    }
  ];
};
```

**IDs comunes de shortcuts en Zen:**
- `cmd_newTab`: Nueva pesta√±a
- `cmd_closeTab`: Cerrar pesta√±a
- `cmd_undoCloseTab`: Reabrir pesta√±a cerrada
- `cmd_newWindow`: Nueva ventana
- `cmd_toggleSidebar`: Mostrar/ocultar sidebar
- `cmd_goBack`: Ir atr√°s
- `cmd_goForward`: Ir adelante
- `cmd_reload`: Recargar p√°gina
- `cmd_find`: Buscar en p√°gina

Para encontrar m√°s IDs, ejecuta Zen y revisa:
```
~/.zen/default/zen-keyboard-shortcuts.json
```

### Otras opciones disponibles

#### Spaces/Workspaces

Configuraci√≥n de espacios de trabajo:

```nix
profiles.default = {
  spaces = {
    work = {
      id = "uuid-aqui";  # Genera un UUID v4
      name = "Work";
      position = 0;
      icon = "üíº";
    };
  };
};
```

#### Pins

Pesta√±as fijadas:

```nix
profiles.default = {
  pins = {
    gmail = {
      id = "uuid-aqui";
      title = "Gmail";
      url = "https://mail.google.com";
      position = 0;
    };
  };
};
```

#### Mods

Temas desde la tienda de Zen:

```nix
profiles.default = {
  mods = [
    "mod-uuid-1"
    "mod-uuid-2"
  ];
};
```

Encuentra mods en: https://zen-browser.github.io/theme-store/

## Aplicar cambios

Despu√©s de modificar `zen.nix`:

```bash
make switch
# o
home-manager switch
```

Luego reinicia Zen Browser para que los cambios surtan efecto.

## Navegador por defecto

Zen Browser est√° configurado como navegador por defecto v√≠a:
- **XDG MIME Apps**: Configurado para abrir enlaces http/https
- **Variable de entorno**: `BROWSER=zen` (usada por Hyprland y scripts)

El archivo `.desktop` se llama `zen-twilight.desktop` (no `zen-browser.desktop`).

---

## Helium Browser

**Helium** es un navegador basado en Chromium con un enfoque fuerte en **seguridad, privacidad y comfort**. Est√° configurado con flags optimizados que reducen el tracking, fingerprinting y la recolecci√≥n de datos, adem√°s de mejoras de rendimiento.

### Configuraci√≥n

La configuraci√≥n de Helium se encuentra en:
```
modules/hm/programs/browsers/helium.nix
```

### Seguridad y Privacidad

Helium est√° configurado con m√∫ltiples medidas de privacidad y seguridad:

- **Protecci√≥n contra fingerprinting**: Ruido a√±adido a canvas, measuretext y client-rects para dificultar la identificaci√≥n √∫nica del navegador
- **Sin recolecci√≥n de datos**: Deshabilitada la recolecci√≥n de motores de b√∫squeda y telemetr√≠a
- **Manejo seguro de extensiones**: Configuraci√≥n que requiere confirmaci√≥n expl√≠cita para instalar extensiones
- **Dominios punycode forzados**: Mejora la seguridad al mostrar dominios internacionales en formato punycode
- **Sin pings**: Deshabilitados los pings de red para evitar tracking

### Caracter√≠sticas t√©cnicas

- **Basado en Chromium**: Compatible con extensiones de Chrome
- **Flags optimizados**: Utiliza los flags compartidos de `chromium-flags.nix` para rendimiento y privacidad

### Flags de Chromium

Helium utiliza los flags compartidos definidos en `chromium-flags.nix`, que incluyen:

- **Wayland support**: Soporte nativo para Wayland
- **GPU acceleration**: Aceleraci√≥n por hardware para video y gr√°ficos
- **Vulkan backend**: Renderizado con Vulkan
- **VAAPI**: Decodificaci√≥n de video acelerada por hardware
- **Privacidad**: Flags para reducir fingerprinting y tracking

Las variables de entorno configuradas incluyen (para Intel GPU):
- `LIBVA_DRIVER_NAME=i965` (Intel VAAPI driver)
- `EGL_PLATFORM=wayland`
- `ENABLE_VAAPI=1`
- `ENABLE_VDPAU=1`

---

## Google Chrome

**Google Chrome** es el navegador est√°ndar de Google, configurado **sin modificaciones** para mantener compatibilidad con herramientas de trabajo y evitar problemas con sitios corporativos.

### Configuraci√≥n

La configuraci√≥n de Google Chrome se encuentra en:
```
modules/hm/programs/browsers/google-chrome.nix
```

### Uso

Google Chrome se instala **sin flags ni modificaciones** por dise√±o:
- ‚úÖ **Sin flags de privacidad** - Para evitar problemas con sitios corporativos
- ‚úÖ **Sin modificaciones de comportamiento** - Compatibilidad total con herramientas de trabajo
- ‚úÖ **Configuraci√≥n est√°ndar** - Funciona como Chrome oficial sin personalizaciones

Si necesitas flags personalizados (no recomendado para trabajo), puedes agregar:

```nix
home.sessionVariables = {
  GOOGLE_CHROME_EXTRA_FLAGS = "--some-flag";
};
```

---

## Flags compartidos de Chromium

El archivo `chromium-flags.nix` contiene flags optimizados para navegadores basados en Chromium. **Actualmente, estos flags se aplican a Helium** a trav√©s de variables de entorno. **Google Chrome no est√° usando estos flags por defecto**, pero puedes configurarlos si lo deseas.

### Explicaci√≥n detallada de los flags

#### Wayland Support
```nix
--ozone-platform=wayland
--enable-features=WaylandWindowDecorations
```
- **`--ozone-platform=wayland`**: Usa Wayland como plataforma de ventanas (mejor rendimiento y soporte nativo en Linux)
- **`--enable-features=WaylandWindowDecorations`**: Habilita decoraciones de ventana nativas de Wayland

#### GPU y Aceleraci√≥n de Video
```nix
--use-vulkan=native
--enable-dawn-backend=vulkan
--ignore-gpu-blocklist
--enable-gpu-rasterization
--enable-zero-copy
--enable-raw-draw
--enable-drdc
--disable-gpu-driver-bug-workarounds
```
- **`--use-vulkan=native`**: Usa Vulkan como API de gr√°ficos (mejor rendimiento que OpenGL)
- **`--enable-dawn-backend=vulkan`**: Backend Vulkan para WebGPU
- **`--ignore-gpu-blocklist`**: Ignora la lista negra de GPUs (permite usar GPU aunque no est√© oficialmente soportada)
- **`--enable-gpu-rasterization`**: Usa GPU para rasterizar (renderizar) p√°ginas web
- **`--enable-zero-copy`**: Reduce copias de memoria innecesarias (mejor rendimiento)
- **`--enable-raw-draw`**: Renderizado directo sin capas intermedias
- **`--enable-drdc`**: Dynamic Refresh Rate Control (mejor sincronizaci√≥n)
- **`--disable-gpu-driver-bug-workarounds`**: Desactiva workarounds para bugs de drivers (mejor rendimiento si tu driver es estable)

#### Features de Rendimiento
```nix
--enable-features=UseOzonePlatform,Vulkan,SkiaGraphite,VaapiVideoEncoder,VaapiVideoDecoder,CanvasOopRasterization,VaapiIgnoreDriverChecks,OverlayScrollbar,ParallelDownloading
```
- **`UseOzonePlatform`**: Plataforma de ventanas moderna
- **`Vulkan`**: Renderizado con Vulkan
- **`SkiaGraphite`**: Motor de gr√°ficos mejorado
- **`VaapiVideoEncoder/VaapiVideoDecoder`**: Codificaci√≥n/decodificaci√≥n de video con VAAPI (aceleraci√≥n por hardware)
- **`CanvasOopRasterization`**: Rasterizaci√≥n fuera de proceso para canvas
- **`VaapiIgnoreDriverChecks`**: Ignora verificaciones de drivers VAAPI
- **`OverlayScrollbar`**: Barras de desplazamiento overlay (m√°s espacio)
- **`ParallelDownloading`**: Descargas paralelas (m√°s r√°pido)

#### Aceleraci√≥n de Video Espec√≠fica
```nix
--enable-hardware-overlays
--enable-accelerated-video-decode
--enable-accelerated-video-encode
--enable-accelerated-mjpeg-decode
```
- **`--enable-hardware-overlays`**: Overlays de hardware (mejor rendimiento de video)
- **`--enable-accelerated-video-decode`**: Decodificaci√≥n de video acelerada por hardware
- **`--enable-accelerated-video-encode`**: Codificaci√≥n de video acelerada por hardware
- **`--enable-accelerated-mjpeg-decode`**: Decodificaci√≥n de JPEG acelerada

#### Rendimiento General
```nix
--enable-oop-rasterization
--enable-webgl-developer-extensions
--enable-accelerated-2d-canvas
--enable-direct-composition
--enable-gpu-compositing
```
- **`--enable-oop-rasterization`**: Rasterizaci√≥n fuera de proceso (mejor estabilidad)
- **`--enable-webgl-developer-extensions`**: Extensiones de desarrollo para WebGL
- **`--enable-accelerated-2d-canvas`**: Canvas 2D acelerado por GPU
- **`--enable-direct-composition`**: Composici√≥n directa (mejor rendimiento)
- **`--enable-gpu-compositing`**: Composici√≥n con GPU

#### Navegaci√≥n Suave
```nix
--enable-media-router
--enable-smooth-scrolling
```
- **`--enable-media-router`**: Router de medios (para casting, etc.)
- **`--enable-smooth-scrolling`**: Desplazamiento suave

#### Privacidad y Seguridad (UnGoogled)
```nix
--disable-search-engine-collection
--extension-mime-request-handling=always-prompt-for-install
--fingerprinting-canvas-image-data-noise
--fingerprinting-canvas-measuretext-noise
--fingerprinting-client-rects-noise
--popups-to-tabs
--force-punycode-hostnames
--show-avatar-button=incognito-and-guest
--no-pings
```
- **`--disable-search-engine-collection`**: Desactiva recolecci√≥n de motores de b√∫squeda
- **`--extension-mime-request-handling=always-prompt-for-install`**: Siempre pregunta antes de instalar extensiones
- **`--fingerprinting-canvas-image-data-noise`**: A√±ade ruido a canvas para prevenir fingerprinting
- **`--fingerprinting-canvas-measuretext-noise`**: A√±ade ruido a measureText para prevenir fingerprinting
- **`--fingerprinting-client-rects-noise`**: A√±ade ruido a getBoundingClientRect para prevenir fingerprinting
- **`--popups-to-tabs`**: Convierte popups en pesta√±as (m√°s seguro)
- **`--force-punycode-hostnames`**: Fuerza punycode en nombres de dominio (previene ataques de homograf√≠a)
- **`--show-avatar-button=incognito-and-guest`**: Solo muestra avatar en modo inc√≥gnito/guest
- **`--no-pings`**: Desactiva pings de red (previene tracking)

#### Miscel√°neos
```nix
--disable-features=UseChromeOSDirectVideoDecoder
--no-default-browser-check
```
- **`--disable-features=UseChromeOSDirectVideoDecoder`**: Desactiva decodificador directo de ChromeOS (no aplicable en Linux)
- **`--no-default-browser-check`**: No verifica si es el navegador por defecto al iniciar

### Variables de Entorno

Las variables de entorno configuran el sistema para usar aceleraci√≥n de hardware. **Configurado para Intel GPU (i915 driver)**:

```nix
LIBVA_DRIVER_NAME = "i965"                # Driver VAAPI para Intel (i965 legacy, iHD moderno)
LIBVA_MESSAGING_LEVEL = "1"              # Nivel de mensajes de VAAPI
LIBGL_ALWAYS_SOFTWARE = "0"              # No forzar software rendering
ENABLE_VAAPI = "1"                        # Habilitar VAAPI
ENABLE_VDPAU = "1"                        # Habilitar VDPAU (otro sistema de aceleraci√≥n)
VAAPI_DISABLE_ENCODER_CHECKING = "1"     # Desactivar verificaciones de encoder
EGL_PLATFORM = "wayland"                  # Usar Wayland para EGL
```

**Nota**: Esta configuraci√≥n es para **Intel HD Graphics con driver i915**. Para AMD, cambiar√≠as:
- `LIBVA_DRIVER_NAME = "radeonsi"` (para AMD)
- Agregar `AMD_VULKAN_ICD = "RADV"` y `RADV_PERFTEST = "sam"` (para AMD)

### Aplicar flags a Google Chrome

**Google Chrome NO usa estos flags intencionalmente** - est√° configurado sin modificaciones para mantener compatibilidad con herramientas de trabajo. **Helium es el navegador que usa estos flags** para privacidad y comfort.

Si por alguna raz√≥n quisieras aplicar flags a Google Chrome (no recomendado), podr√≠as modificar `google-chrome.nix`:

```nix
{ pkgs, ... }:
let
  chromiumFlags = import ./chromium-flags.nix { inherit pkgs; };
in {
  home.packages = [ pkgs.google-chrome ];
  
  # Aplicar variables de entorno
  home.sessionVariables = chromiumFlags.sessionVariables;
  
  # Aplicar flags (requiere wrapper personalizado)
  # Nota: Google Chrome no acepta flags directamente v√≠a variable de entorno
  # Necesitar√≠as crear un wrapper o usar un archivo de flags
}
```

**Nota importante**: Google Chrome no acepta flags v√≠a `GOOGLE_CHROME_EXTRA_FLAGS` de la misma forma que Chromium. Para aplicar flags a Google Chrome, necesitar√≠as:
1. Crear un wrapper personalizado del paquete
2. O usar un archivo de configuraci√≥n de flags (si Chrome lo soporta)
3. O usar Chromium en lugar de Google Chrome (que s√≠ acepta flags m√°s f√°cilmente)

