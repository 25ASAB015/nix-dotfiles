---
title: Tmux & Workmux
description: Gu√≠a completa para el uso del multiplexor de terminal Tmux y el gestor de flujos de trabajo Workmux
---

# Tmux & Workmux

Esta gu√≠a cubre el uso de **Tmux**, el multiplexor de terminales, y **Workmux**, una herramienta poderosa para gestionar flujos de trabajo paralelos con Git Worktrees y agentes de IA.

## Tmux: Multiplexor de Terminales

**Tmux** (Terminal Multiplexer) permite ejecutar m√∫ltiples sesiones de terminal dentro de una sola ventana. Es esencial para mantener procesos en ejecuci√≥n, organizar √°reas de trabajo y mejorar la productividad en la terminal.

### Conceptos B√°sicos

- **Sesi√≥n**: Un conjunto de ventanas. Puedes desconectarte (detach) de una sesi√≥n y dejarla corriendo en segundo plano, para luego reconectarte (attach).
- **Ventana (Window)**: Como una pesta√±a en un navegador. Ocupa toda la pantalla.
- **Panel (Pane)**: Subdivisiones dentro de una ventana. Permite ver m√∫ltiples terminales simult√°neamente.

### Instalaci√≥n

Tmux est√° instalado por defecto en tu configuraci√≥n de usuario ([`hosts/hydenix/user.nix`](file:///home/ludus/Dotfiles/hosts/hydenix/user.nix)) y configurado con **Oh my tmux!**, un framework de configuraci√≥n moderno y visualmente atractivo.

---

## Oh my tmux! - Configuraci√≥n Mejorada

**Oh my tmux!** es un framework de configuraci√≥n para tmux que proporciona una experiencia mejorada con tema visual inspirado en Powerline, bindings intuitivos y caracter√≠sticas avanzadas.

### ¬øQu√© es Oh my tmux!?

[Oh my tmux!](https://github.com/gpakosz/.tmux) es una configuraci√≥n de tmux:
- **Auto-contenida**: No requiere dependencias complejas
- **Visualmente atractiva**: Tema Powerline con s√≠mbolos especiales
- **Altamente personalizable**: Archivo de configuraci√≥n local para tus ajustes
- **Bien documentada**: Incluye comentarios detallados en la configuraci√≥n

### Caracter√≠sticas Principales

#### üé® Tema Visual Moderno
- **Powerline symbols**: Separadores y s√≠mbolos especiales para una barra de estado elegante
- **Tema Nord**: Paleta de colores moderna y agradable a la vista
- **Indicadores visuales**: Bater√≠a, uptime, hostname, estado de sincronizaci√≥n

#### ‚å®Ô∏è Bindings Mejorados
- **Doble prefijo**: `Ctrl+a` (principal) y `Ctrl+b` (alternativo)
- **Navegaci√≥n Vim-style**: `h/j/k/l` para moverse entre paneles
- **Splits intuitivos**: `|` para divisi√≥n vertical, `-` para horizontal
- **Maximizar paneles**: `prefix + +` para maximizar/restaurar

#### üîß Funcionalidades Avanzadas
- **Mouse mode**: Toggle con `prefix + m`
- **Clipboard integration**: Copia autom√°tica al portapapeles del sistema
- **SSH-aware**: Muestra informaci√≥n de hostname cuando est√°s en SSH
- **TPM support**: Soporte para Tmux Plugin Manager

### Configuraci√≥n en tus Dotfiles

La configuraci√≥n de Oh my tmux! est√° gestionada por Nix/Home Manager:

```
modules/hm/programs/terminal/
‚îú‚îÄ‚îÄ tmux.nix              # M√≥dulo Nix para gesti√≥n de configuraci√≥n
‚îú‚îÄ‚îÄ oh-my-tmux.conf       # Configuraci√≥n principal de Oh my tmux!
‚îî‚îÄ‚îÄ tmux.conf.local       # Tu configuraci√≥n personalizada
```

Los archivos se enlazan simb√≥licamente a:
- `~/.config/tmux/tmux.conf` ‚Üí Configuraci√≥n principal
- `~/.config/tmux/tmux.conf.local` ‚Üí Configuraci√≥n personalizada

> [!IMPORTANT]
> **Nunca modifiques** `oh-my-tmux.conf` directamente. Todas tus personalizaciones deben ir en `tmux.conf.local`.

### Teclas R√°pidas (Keybindings)

El **prefijo** en esta configuraci√≥n es `Ctrl+a` (tambi√©n funciona `Ctrl+b`).

#### üìã Gesti√≥n de Sesiones
- `prefix + d`: Desconectar (detach) de la sesi√≥n actual
- `prefix + s`: Listar y cambiar entre sesiones
- `prefix + C-c`: Crear nueva sesi√≥n
- `prefix + C-f`: Buscar sesi√≥n por nombre
- `tmux new -s nombre`: Crear sesi√≥n llamada "nombre"
- `tmux a -t nombre`: Reconectarse a sesi√≥n "nombre"
- `tmux ls`: Listar todas las sesiones

#### ü™ü Gesti√≥n de Ventanas
- `prefix + c`: Crear nueva ventana
- `prefix + ,`: Renombrar ventana actual
- `prefix + C-h`: Ir a ventana anterior
- `prefix + C-l`: Ir a ventana siguiente
- `prefix + Tab`: Ir a √∫ltima ventana activa
- `prefix + 0-9`: Ir a ventana n√∫mero X
- `prefix + w`: Listar ventanas (modo √°rbol)
- `prefix + &`: Cerrar ventana actual (confirmar con `y`)

#### üìê Gesti√≥n de Paneles
- `prefix + |`: Dividir verticalmente (nuevo binding intuitivo)
- `prefix + -`: Dividir horizontalmente (nuevo binding intuitivo)
- `prefix + h/j/k/l`: Navegar entre paneles (Vim-style)
- `prefix + H/J/K/L`: Redimensionar paneles (Vim-style)
- `prefix + </>`: Intercambiar paneles
- `prefix + +`: Maximizar/restaurar panel actual
- `prefix + z`: Zoom en panel actual (toggle)
- `prefix + x`: Cerrar panel actual
- `prefix + !`: Convertir panel en ventana

#### üìù Modo Copia (Vi-style)
- `prefix + Enter`: Entrar en modo copia
- `v`: Iniciar selecci√≥n visual
- `C-v`: Toggle selecci√≥n rectangular
- `y`: Copiar selecci√≥n (y salir)
- `H`: Ir al inicio de l√≠nea
- `L`: Ir al final de l√≠nea
- `Escape`: Cancelar modo copia

#### üõ†Ô∏è Utilidades
- `prefix + e`: Editar configuraci√≥n local con `$EDITOR`
- `prefix + r`: Recargar configuraci√≥n
- `prefix + m`: Toggle mouse mode
- `prefix + U`: Abrir Urlscan/Urlview (si est√° instalado)
- `prefix + F`: Abrir Facebook PathPicker (si est√° instalado)
- `C-l`: Limpiar pantalla **y** historial de tmux

### Personalizaci√≥n

Para personalizar tu configuraci√≥n, edita [`modules/hm/programs/terminal/tmux.conf.local`](file:///home/ludus/Dotfiles/modules/hm/programs/terminal/tmux.conf.local).

#### Cambiar Tema de Colores

La configuraci√≥n actual usa el tema **Nord**. Para cambiar colores:

```bash
# En tmux.conf.local, busca las variables tmux_conf_theme_*
tmux_conf_theme_pane_active_border='#88c0d0'  # Color del borde activo
tmux_conf_theme_status_bg='#2e3440'           # Fondo de barra de estado
```

#### Personalizar Barra de Estado

```bash
# Lado izquierdo (sesi√≥n, uptime)
tmux_conf_theme_status_left=' ‚ùê #S | ‚Üë#{uptime_h}h #{uptime_m}m '

# Lado derecho (bater√≠a, fecha, hostname)
tmux_conf_theme_status_right='üîã #{battery_percentage} | %H:%M | #{hostname} '
```

Variables disponibles:
- `#{battery_percentage}`, `#{battery_status}`, `#{battery_bar}`
- `#{uptime_y}`, `#{uptime_d}`, `#{uptime_h}`, `#{uptime_m}`
- `#{hostname}`, `#{hostname_ssh}`, `#{username}`
- `#{prefix}`, `#{synchronized}`, `#{pairing}`

#### Habilitar Plugins (TPM)

Para usar plugins de tmux, descomenta en `tmux.conf.local`:

```bash
# Ejemplos de plugins √∫tiles
set -g @plugin 'tmux-plugins/tmux-resurrect'  # Guardar/restaurar sesiones
set -g @plugin 'tmux-plugins/tmux-continuum'  # Auto-guardar sesiones
set -g @plugin 'tmux-plugins/tmux-yank'       # Mejor integraci√≥n de clipboard
```

Luego instala con: `prefix + I` (Shift+i)

#### Cambiar Bindings

Para sobrescribir un binding de Oh my tmux!, agrega `#!important`:

```bash
# En tmux.conf.local
bind c new-window -c '#{pane_current_path}' #!important
```

### Integraci√≥n con Workmux

Oh my tmux! est√° optimizado para trabajar con Workmux:

- **Automatic window naming**: Las ventanas se renombran autom√°ticamente seg√∫n el worktree
- **Aggressive resize**: Mejor soporte multi-cliente
- **Retain current path**: Nuevos paneles/ventanas mantienen el directorio actual

Cuando uses `workmux add`, tmux crear√° autom√°ticamente ventanas con el layout configurado.

### Troubleshooting

#### Los s√≠mbolos Powerline no se muestran correctamente

**Causa**: Tu fuente no incluye los s√≠mbolos Powerline.

**Soluci√≥n**:
1. Instala una [Nerd Font](https://www.nerdfonts.com/) (recomendado: JetBrainsMono Nerd Font)
2. Configura tu terminal para usar esa fuente
3. Alternativamente, cambia los separadores en `tmux.conf.local`:

```bash
# Usar s√≠mbolos ASCII simples
tmux_conf_theme_left_separator_main='|'
tmux_conf_theme_left_separator_sub='|'
tmux_conf_theme_right_separator_main='|'
tmux_conf_theme_right_separator_sub='|'
```

#### La barra de estado se duplica o se ve rota

**Causa**: Incompatibilidad entre versi√≥n de Unicode de glib y glibc.

**Soluci√≥n**: Ya est√° configurado para evitar caracteres Unicode problem√°ticos. Si persiste:
1. Verifica que `LC_CTYPE` use locale UTF-8
2. En iTerm2: desactiva "Use Unicode version 9 character widths"

#### Los colores no se ven correctamente

**Causa**: Terminal no soporta 256 colores o true color.

**Soluci√≥n**:
1. Verifica que `$TERM` sea `xterm-256color` (ya configurado en `tmux.nix`)
2. Aseg√∫rate que tu emulador de terminal soporte true color
3. Prueba con: `tmux info | grep Tc`

#### Tmux no carga la configuraci√≥n

**Causa**: Symlinks no creados correctamente.

**Soluci√≥n**:
```bash
# Reconstruir configuraci√≥n de Home Manager
nixos-rebuild switch --flake .#hydenix

# Verificar symlinks
ls -la ~/.config/tmux/
```

#### El clipboard no funciona

**Causa**: Falta `xclip`, `xsel`, o `wl-clipboard`.

**Soluci√≥n**: Oh my tmux! detecta autom√°ticamente la herramienta disponible. Aseg√∫rate de tener una instalada:
```bash
# Para X11
nix-shell -p xclip

# Para Wayland
nix-shell -p wl-clipboard
```

### Comandos √ötiles

```bash
# Ver todas las sesiones
tmux ls

# Crear sesi√≥n con nombre
tmux new -s desarrollo

# Adjuntar a sesi√≥n existente
tmux attach -t desarrollo

# Matar sesi√≥n espec√≠fica
tmux kill-session -t desarrollo

# Matar todas las sesiones excepto la actual
tmux kill-session -a

# Listar todos los bindings
prefix + ?

# Ver informaci√≥n de tmux
tmux info

# Recargar configuraci√≥n manualmente
tmux source-file ~/.config/tmux/tmux.conf
```

---

## Sesh: Smart Session Manager

**Sesh** es un gestor de sesiones inteligente que potencia el flujo de trabajo de tmux. Permite crear y conectar sesiones r√°pidamente bas√°ndose en directorios (v√≠a zoxide), configuraciones y sesiones activas.

### Caracter√≠sticas
- **B√∫squeda difusa (fzf)**: Encuentra cualquier proyecto o sesi√≥n instant√°neamente.
- **Detecci√≥n inteligente**: Crea sesiones autom√°ticamente si no existen.
- **Integraci√≥n con Zoxide**: Salta a tus directorios m√°s frecuentes como sesiones de tmux.
- **Configuraci√≥n declarativa**: Define sesiones base y comandos de inicio en `sesh.toml`.

### Uso en Tmux
He configurado dos bindings para lanzar sesh dentro de un popup de tmux:

- `prefix + T`: Abre el buscador de sesh con **fzf** (completo, con headers y buscador de archivos).
- `prefix + K`: Abre el buscador de sesh con **gum** (minimalista, r√°pido y moderno).

#### Sesh + Fzf (Buscador Completo)
Dentro del buscador de `prefix + T` puedes usar:
- `Ctrl+a`: Ver todo (sesiones + directorios)
- `Ctrl+t`: Ver solo sesiones de tmux activas
- `Ctrl+g`: Ver solo proyectos configurados en `sesh.toml`
- `Ctrl+x`: Ver directorios de Zoxide
- `Ctrl+f`: Buscar directorios con `fd`
- `Ctrl+d`: Matar la sesi√≥n seleccionada

#### Sesh + Gum (Buscador R√°pido)
Con `prefix + K` obtienes una interfaz m√°s limpia impulsada por `gum filter`. Es ideal para saltar r√°pidamente entre sesiones conocidas sin la complejidad visual de fzf.

### Uso en la Terminal (Zsh)
Tambi√©n puedes usar sesh directamente desde tu shell sin estar dentro de tmux:

- **Zsh**: Presiona `Alt + g` para abrir el selector de sesiones de sesh. Si seleccionas una, te conectar√° autom√°ticamente (lanzando tmux si es necesario).

### Configuraci√≥n Creativa
La configuraci√≥n reside en [`modules/hm/programs/terminal/sesh.nix`](file:///home/ludus/Dotfiles/modules/hm/programs/terminal/sesh.nix). Aqu√≠ tienes ejemplos de sesiones configuradas con iconos y comandos de inicio:

```toml
[[session]]
name = "Dotfiles ‚öôÔ∏è"
path = "~/Dotfiles"
startup_command = "nvim ."
preview_command = "eza --all --git --icons --color=always {}"

[[session]]
name = "Work üíº"
path = "~/Work"
startup_command = "ls"
preview_command = "eza --all --git --icons --color=always {}"

[[session]]
name = "Tmux Config ‚å®Ô∏è"
path = "~/Dotfiles/modules/hm/programs/terminal"
startup_command = "nvim tmux.conf.local"
preview_command = "bat --color=always --style=numbers tmux.conf.local"

[[session]]
name = "NixOS Config ‚ùÑÔ∏è"
path = "~/Dotfiles"
startup_command = "nvim hosts/hydenix/configuration.nix"
```

---

### Mantenimiento y Actualizaciones

#### M√©todo Automatizado (Recomendado)

Para mantener tus dotfiles, submodules y el sistema actualizados en un solo paso (el comando "todo en uno"), usa:

```bash
make upd-upgrade
```

Este comando orquestar√° autom√°ticamente:
1. La actualizaci√≥n de submodules git (incluyendo Oh my tmux!).
2. La sincronizaci√≥n de archivos de configuraci√≥n externos.
3. La actualizaci√≥n de todos los inputs del flake de Nix.
4. La aplicaci√≥n segura de la configuraci√≥n al sistema.

#### Otros Comandos de Actualizaci√≥n

Si necesitas realizar actualizaciones parciales:

```bash
# Sincronizar solo submodules y archivos de configuraci√≥n
make upd-dots

# Actualizar solo los inputs del flake (Nix)
make upd-all

# Actualizar herramientas de IA (OpenCode, Antigravity, etc.)
make upd-ai
```

#### M√©todo Manual (Detallado)

Si prefieres realizar los pasos manualmente o necesitas debuggear:

```bash
# 1. Actualizar el submodule a la √∫ltima versi√≥n upstream
make/upd-dots.sh  # (El script contiene la l√≥gica de sincronizaci√≥n)
```

O paso a paso:

```bash
# 1. Actualizar el submodule
git submodule update --remote modules/hm/programs/terminal/oh-my-tmux

# 2. Copiar la nueva configuraci√≥n principal
cp modules/hm/programs/terminal/oh-my-tmux/.tmux.conf \
   modules/hm/programs/terminal/oh-my-tmux.conf

# 3. Aplicar configuraci√≥n
make sys-apply
```

### Recursos Adicionales

- [Oh my tmux! GitHub](https://github.com/gpakosz/.tmux)
- [Tmux Getting Started Guide](https://github.com/tmux/tmux/wiki/Getting-Started)
- [Tmux Cheat Sheet](https://tmuxcheatsheet.com/)
- [Libro: tmux 3 - Productive Mouse-Free Development](https://pragprog.com/titles/bhtmux3/tmux-3/)

---

## Workmux: Flujos de Trabajo Paralelos

**Workmux** es una herramienta de "cero fricci√≥n" para gestionar **Git Worktrees** y sesiones de Tmux como entornos de desarrollo aislados. Es ideal para trabajar en m√∫ltiples caracter√≠sticas o correcciones simult√°neamente sin conflictos, y perfecto para orquestar m√∫ltiples agentes de IA.

> **Worktree**: Una caracter√≠stica de Git que permite tener m√∫ltiples copias de trabajo del mismo repositorio en diferentes directorios, todas vinculadas al mismo historial `.git`.

### Caracter√≠sticas Principales

- **Una ventana por tarea**: Cada tarea tiene su propia ventana de Tmux, estado de terminal, editor y servidores.
- **Git Worktrees**: Crea worktrees autom√°ticamente en directorios hermanos (`../proyecto__worktrees/rama`).
- **Integraci√≥n con IA**: Dise√±ado para trabajar con agentes como Claude Code, Gemini CLI, etc.
- **Configuraci√≥n flexible**: Soporta configuraci√≥n global y por proyecto.

### Instalaci√≥n

Workmux se instala a trav√©s de `llm-agents` en tu configuraci√≥n (`hosts/hydenix/user.nix`).

### Comandos Principales

Se recomienda crear un alias en tu shell: `alias wm='workmux'`

#### 1. Iniciar (`workmux add`)

Crea un nuevo worktree y una ventana de Tmux asociada.

```bash
# Crear nueva rama y worktree
workmux add nueva-feature

# Usar una rama existente
workmux add rama-existente

# Crear desde una base espec√≠fica
workmux add hotfix --base production

# Crear un worktree para un PR de GitHub
workmux add --pr 123
```

Esto realizar√° autom√°ticamente:
1. Crear un worktree de git en una carpeta separada.
2. Crear una ventana de Tmux (ej. `wm-nueva-feature`).
3. Configurar el layout de paneles definido.
4. Cambiarte a esa nueva ventana.

#### 2. Finalizar (`workmux merge` / `remove`)

Cuando termines tu tarea:

```bash
# Fusionar rama a main y limpiar todo (worktree, ventana, rama)
workmux merge

# Si usas Pull Requests (el merge ocurre en remoto), solo elimina el entorno local
workmux remove
```

#### 3. Navegaci√≥n

- `workmux list`: Ver worktrees activos.
- `workmux open <nombre>`: Abrir la ventana de un worktree existente.
- `workmux close`: Cerrar la ventana (mantiene el worktree).

### Integraci√≥n con Agentes de IA

Workmux brilla cuando se usa con agentes de IA. Puedes iniciar un entorno de trabajo con un agente pre-cargado con instrucciones.

```bash
# Crear worktree con un prompt para el agente
workmux add feature/login --prompt "Implementar login con OAuth2 usando Google"

# Usar un agente espec√≠fico (si tienes varios configurados)
workmux add feature/refactor -a gemini
```

Si tienes configurado `agent: claude` (por defecto), Workmux abrir√° un panel con `claude` (o el agente configurado) y le pasar√° tu prompt autom√°ticamente.

### Configuraci√≥n (`.workmux.yaml`)

Puedes configurar Workmux globalmente (`~/.config/workmux/config.yaml`) o por proyecto (`.workmux.yaml`).

Ejemplo de configuraci√≥n de proyecto:

```yaml
# .workmux.yaml

# Comandos a ejecutar tras crear el worktree (antes de abrir tmux)
post_create:
  - direnv allow
  - pnpm install

# Archivos a copiar o enlazar desde el directorio principal
files:
  copy:
    - .env
  symlink:
    - node_modules

# Layout de paneles de Tmux
panes:
  - command: <agent>       # Panel 1: Agente de IA (recibe el prompt)
    focus: true
  - command: pnpm run dev  # Panel 2: Servidor de desarrollo
    split: horizontal
```

### Generaci√≥n Autom√°tica de Nombres

Workmux puede usar IA (v√≠a `llm` CLI) para generar nombres de rama basados en tu descripci√≥n:

```bash
# Te pedir√° un prompt y generar√° un nombre de rama adecuado (ej. "implement-oauth")
workmux add -A
```

### Dashboard

Usa `workmux dashboard` para ver una interfaz TUI con el estado de todos tus agentes y worktrees activos.

---

## Flujo de Trabajo Recomendado

1.  **Nuevo Ticket/Tarea**:
    `workmux add feature/nueva-api --prompt "Crear endpoint REST para usuarios"`
    
    *Workmux crea el worktree, instala dependencias (si est√° configurado), abre Tmux, divide la pantalla, e inicia al agente con las instrucciones.*

2.  **Desarrollo**:
    Trabajas en el entorno aislado. El agente modifica c√≥digo, t√∫ revisas, el servidor corre en otro panel.

3.  **Context Switching**:
    Si llega un bug urgente:
    `workmux add hotfix/crash-prod`
    
    *Cambias instant√°neamente a un entorno limpio para el hotfix. Tu trabajo en `feature/nueva-api` sigue corriendo intacto en su ventana.*

4.  **Finalizaci√≥n**:
    En la ventana del hotfix: `workmux merge` (o `gh pr create` y luego `workmux remove`).
    Vuelves a tu tarea anterior con `workmux open feature/nueva-api`.
