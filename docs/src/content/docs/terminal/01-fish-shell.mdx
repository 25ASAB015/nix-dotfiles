---
title: Fish Shell
description: Configuraci√≥n completa de Fish shell con plugins, keybindings y herramientas integradas
---

# üêü Fish Shell

**Fish** (Friendly Interactive Shell) es un shell moderno con autocompletado inteligente, sintaxis coloreada y configuraci√≥n sencilla. Esta configuraci√≥n est√° basada en [kaku](https://github.com/linuxmobile/kaku) y proporciona una experiencia de shell productiva y personalizada.

La configuraci√≥n se encuentra en:
```
modules/hm/programs/terminal/shell/
```

## Configuraci√≥n Principal

### Archivo de configuraci√≥n

La configuraci√≥n principal de Fish se encuentra en:
```
modules/hm/programs/terminal/shell/fish.nix
```

### Habilitar Fish Shell

En `hydenix-config.nix`:

```nix
modules.terminal.shell.fish = {
  enable = true;
  editor = "nvim";           # Editor por defecto (EDITOR y VISUAL)
  nixosHost = "hydenix";     # Host para comandos nixos-rebuild
};
```

## Caracter√≠sticas Principales

### Variables de Entorno y Secrets

Fish carga autom√°ticamente secrets desde agenix (si existen):

- **DISCORDO_TOKEN** / **OXICORD_TOKEN**: Desde `/run/agenix/discordo`
- **OPENROUTER_API_KEY**: Desde `/run/agenix/openrouter`
- **GITHUB_TOKEN**: Desde `/run/agenix/github`
- **TWT_TOKEN**: Desde `/run/agenix/twt`

Estos se cargan autom√°ticamente si los archivos existen en `/run/agenix/`.

### Keybindings Personalizados

#### Keybindings Vi

Fish usa keybindings estilo Vi por defecto:

- **Modo normal**: Navegaci√≥n y comandos
- **Modo insert**: Edici√≥n de texto
- **Modo visual**: Selecci√≥n de texto

#### Keybindings Personalizados

Keybindings disponibles en ambos modos (insert y default):

- **`Ctrl+Backspace`**: Eliminar palabra anterior
- **`Ctrl+Z`**: Deshacer
- **`Ctrl+B`**: Ir al inicio de l√≠nea
- **`Ctrl+E`**: Ir al final de l√≠nea
- **`Ctrl+X Ctrl+E`**: Editar comando en editor (`edit_command_buffer`)

#### Navegaci√≥n de Historial

- **`‚Üë` / `‚Üì`**: B√∫squeda de historial con prefijo (como nushell)
  - Busca comandos que empiezan con lo que has escrito
  - M√°s eficiente que navegaci√≥n normal

#### Keybindings Deshabilitados (para Zellij)

Los siguientes keybindings est√°n deshabilitados para evitar conflictos con Zellij:

- **`Alt+S`**: Deshabilitado
- **`Alt+V`**: Deshabilitado
- **`Alt+Z`**: Deshabilitado

### Cursor Shapes por Modo

El cursor cambia de forma seg√∫n el modo Vi:

- **Default**: `block` (bloque s√≥lido)
- **Insert**: `line` (l√≠nea vertical)
- **Replace**: `underscore` (guion bajo)
- **Visual**: `block` (bloque s√≥lido)

### Colores de Sintaxis

- **Autosugerencias**: `brblack` (gris oscuro)
- **Comandos**: `blue`
- **Errores**: `red`
- **Par√°metros**: `normal` (color por defecto)

## Plugins Instalados

Fish incluye los siguientes plugins:

1. **autopair**: Cierra par√©ntesis, comillas y brackets autom√°ticamente
2. **done**: Notificaci√≥n cuando termina un comando largo (m√≠nimo 10 segundos)
3. **bass**: Ejecutar scripts bash en Fish
4. **plugin-git**: Aliases extendidos de Git
5. **plugin-sudope**: `Ctrl+S` para agregar `sudo` al comando actual
6. **humantime-fish**: Formato legible de tiempo (ej: "2 hours ago")
7. **fifc**: Fuzzy finder para completions (`Ctrl+V` para abrir)
8. **grc**: Coloriza output de comandos
9. **puffer**: Expande `...` a `../../..` autom√°ticamente

### Configuraci√≥n de Plugins

```nix
# Plugin settings en interactiveShellInit
set -Ux fifc_editor nvim        # Editor para fifc
set -U fifc_keybinding \cv      # Keybinding para fifc (Ctrl+V)
set -g __done_min_cmd_duration 10000  # Duraci√≥n m√≠nima para notificaci√≥n (10s)
set -g sudope_sequence \cs      # Keybinding para sudope (Ctrl+S)
```

## üìã Referencia R√°pida: Funciones, Aliases y Abbreviations

### üîß Funciones Personalizadas

Las funciones personalizadas est√°n disponibles directamente en tu shell:

| Funci√≥n | Descripci√≥n | Uso |
|---------|-------------|-----|
| **`fcd`** | Navegar a directorio con fuzzy finder | `fcd`<br/>Busca todos los directorios con `fd` y te permite seleccionar uno con `sk` |
| **`installed`** | Ver paquetes instalados en el sistema | `installed`<br/>Lista solo los nombres de paquetes (sin paths) |
| **`installedall`** | Ver todos los paquetes con path completo | `installedall`<br/>Lista paquetes con su ruta completa y copia al portapapeles |
| **`fm`** | File manager con Yazi | `fm [directorio]`<br/>Abre Yazi y cambia al directorio seleccionado al salir |
| **`gitgrep`** | Buscar en archivos tracked por Git | `gitgrep "patr√≥n"`<br/>Equivalente a `git ls-files \| rg patr√≥n` |

### ‚ö° Abbreviations

Las abbreviations se expanden autom√°ticamente al presionar **espacio**:

| Abbreviation | Se expande a | Descripci√≥n |
|--------------|--------------|-------------|
| **`z`** | `zoxide query` | Navegar a directorio frecuente |
| **`zi`** | `zoxide query -i` | Navegar a directorio (modo interactivo) |

**Ejemplo de uso:**
```fish
# Escribe "z pro" y presiona espacio
z pro  # Se expande a: zoxide query pro
```

### üéØ Aliases por Categor√≠a

#### üì¶ NixOS - Mantenimiento del Sistema

| Alias | Comando | Descripci√≥n |
|-------|---------|-------------|
| **`cleanup`** | `sudo nix-collect-garbage --delete-older-than 1d` | Elimina generaciones m√°s antiguas de 1 d√≠a |
| **`listgen`** | `sudo nix-env -p /nix/var/nix/profiles/system --list-generations` | Lista todas las generaciones del sistema |
| **`nixremove`** | `nix-store --gc` | Ejecuta garbage collection del nix store |
| **`bloat`** | `nix path-info -Sh /run/current-system` | Muestra el tama√±o del sistema actual |
| **`cleanram`** | `sudo sh -c 'sync; echo 3 > /proc/sys/vm/drop_caches'` | Limpia la cach√© de RAM |
| **`trimall`** | `sudo fstrim -va` | Ejecuta TRIM en todos los sistemas de archivos |

#### üî® NixOS - Rebuild

| Alias | Comando | Descripci√≥n |
|-------|---------|-------------|
| **`test-build`** | `sudo nixos-rebuild test --flake .#hydenix` | Prueba la configuraci√≥n sin aplicarla |
| **`switch-build`** | `sudo nixos-rebuild switch --flake .#hydenix` | Aplica la configuraci√≥n permanentemente |

> **Nota**: El host (`hydenix`) se configura en `hydenix-config.nix`. Si cambias el host, estos aliases usar√°n el nuevo valor autom√°ticamente.

#### üóÇÔ∏è Navegaci√≥n y Terminal

| Alias | Comando | Descripci√≥n |
|-------|---------|-------------|
| **`c`** | `clear` | Limpia la pantalla del terminal |
| **`q`** | `exit` | Sale del shell |
| **`temp`** | `cd /tmp/` | Cambia al directorio temporal |

#### üîÄ Git

| Alias | Comando | Descripci√≥n |
|-------|---------|-------------|
| **`add`** | `git add .` | Agrega todos los archivos al staging |
| **`commit`** | `git commit` | Crea un commit (abre editor) |
| **`push`** | `git push` | Env√≠a commits al remoto |
| **`pull`** | `git pull` | Obtiene cambios del remoto |
| **`diff`** | `git diff --staged` | Muestra diferencias de archivos staged |
| **`gcld`** | `git clone --depth 1` | Clona un repositorio (shallow clone) |
| **`gitui`** | `lazygit` | Abre interfaz TUI de Git |

#### üõ†Ô∏è Herramientas Mejoradas

| Alias | Comando | Descripci√≥n |
|-------|---------|-------------|
| **`l`** | `eza -lF --time-style=long-iso --icons` | Lista archivos con formato largo e iconos |
| **`ll`** | `eza -h --git --icons --color=auto --group-directories-first -s extension` | Lista detallada con Git info y agrupaci√≥n |
| **`tree`** | `eza --tree --icons --tree` | Muestra estructura de directorios en √°rbol |
| **`cat`** | `bat --paging=never` | Muestra archivos con syntax highlighting |
| **`moon`** | `curl -s wttr.in/Moon` | Muestra informaci√≥n de la luna |
| **`weather`** | `curl -s wttr.in` | Muestra el clima actual |
| **`store-path`** | `readlink (which $argv)` | Muestra la ruta del store de Nix para un comando |

#### ‚öôÔ∏è Systemd

| Alias | Comando | Descripci√≥n |
|-------|---------|-------------|
| **`us`** | `systemctl --user` | Gestiona servicios de usuario |
| **`rs`** | `sudo systemctl` | Gestiona servicios del sistema (requiere sudo) |

#### üì± Aplicaciones

| Alias | Comando | Descripci√≥n |
|-------|---------|-------------|
| **`zed`** | `zeditor` | Abre Zed Editor |

## Integraciones

### Carapace - Autocompletado Multi-Shell

Carapace proporciona autocompletado inteligente para m√∫ltiples shells. Configuraci√≥n separada en:

```
modules/hm/programs/terminal/shell/carapace.nix
```

**Habilitar:**

```nix
modules.terminal.shell.carapace = {
  enable = true;
};
```

Carapace incluye:
- **carapace**: Motor de autocompletado
- **carapace-bridge**: Puente para m√∫ltiples shells
- **inshellisense**: Autocompletado adicional

Variables de entorno:
- `CARAPACE_BRIDGES = "fish,zsh,bash,inshellisense"`
- `CARAPACE_CACHE_DIR = "~/.cache/carapace"`

### Starship - Prompt Personalizado

Fish usa el mismo prompt de terminal de [omarchy](https://github.com/richen604/omarchy), proporcionando un prompt minimalista y elegante. La configuraci√≥n se encuentra en:

```
modules/hm/programs/terminal/shell/starship.nix
resources/config/fish-starship.toml
```

**Habilitar:**

```nix
modules.terminal.shell.starship = {
  enable = true;
  enableFishIntegration = true;
};
```

El prompt de Fish usa un formato compacto de 1 l√≠nea basado en omarchy:
- **Formato**: `[$directory$git_branch$git_status]($style)$character`

**Caracter√≠sticas del prompt:**
- **Directory**: Directorio actual con truncaci√≥n inteligente (2 niveles con `‚Ä¶/`)
- **Git Branch**: Rama de Git en estilo italic cyan
- **Git Status**: Estado de Git con s√≠mbolos Unicode (‚á° ahead, ‚á£ behind, ‚áï diverged)
- **Character**: S√≠mbolo `‚ùØ` (√©xito) o `‚úó` (error) en bold cyan

**M√≥dulos habilitados:**
- `directory`: Directorio actual con truncaci√≥n a 2 niveles
- `git_branch`: Rama de Git (italic cyan)
- `git_status`: Estado de Git con s√≠mbolos Unicode (cyan)
- `character`: S√≠mbolo de prompt (bold cyan)

**Configuraci√≥n:**
- Archivo fuente: `resources/config/fish-starship.toml` (copiado desde omarchy)
- Se copia a: `~/.config/starship/fish.toml` (solo para Fish)
- **Nota**: Esta configuraci√≥n es exclusiva para Fish y no afecta a zsh/Hydenix

### fzf - Fuzzy Finder

Integraci√≥n con fzf para b√∫squeda fuzzy:

```
modules/hm/programs/terminal/software/fzf.nix
```

**Habilitar:**

```nix
modules.terminal.software.fzf = {
  enable = true;
  enableFishIntegration = true;
};
```

**Configuraci√≥n:**
- Keybindings de fzf cargados autom√°ticamente
- `FZF_DEFAULT_OPTS = "--reverse --height 40% --border"`

### Zoxide - Navegaci√≥n Inteligente

Zoxide aprende tus directorios frecuentes:

```
modules/hm/programs/terminal/software/zoxide.nix
```

**Habilitar:**

```nix
modules.terminal.software.zoxide = {
  enable = true;
  enableFishIntegration = true;
};
```

**Uso:**
- `z carpeta`: Salta a un directorio visitado frecuentemente
- `zi`: Modo interactivo para seleccionar directorio
- Abbreviations: `z` y `zi` se expanden autom√°ticamente

### Atuin - Historial Mejorado

Atuin reemplaza el historial de Fish con una base de datos SQLite:

```
modules/hm/programs/terminal/software/atuin.nix
```

**Habilitar:**

```nix
modules.terminal.software.atuin = {
  enable = true;
  enableFishIntegration = true;
  enableZshIntegration = false;  # No afectar zsh/Hydenix
};
```

**Caracter√≠sticas:**
- B√∫squeda fuzzy con skim
- Filtrado por host y sesi√≥n
- Modo vim para navegaci√≥n
- Sincronizaci√≥n opcional (deshabilitada por defecto)
- Formato compacto

**Configuraci√≥n:**
- `search_mode = "skim"`: Usa skim para b√∫squeda
- `filter_mode = "host"`: Filtra por host actual
- `keymap_mode = "vim-normal"`: Navegaci√≥n estilo vim
- `style = "compact"`: Interfaz compacta
- `history_filter = ["shit"]`: Comandos a ignorar

### Autojump - Navegaci√≥n R√°pida

Autojump aprende tus directorios frecuentes (alternativa a zoxide):

```
modules/hm/programs/terminal/software/autojump.nix
```

**Habilitar:**

```nix
modules.terminal.software.autojump = {
  enable = true;
};
```

**Uso:**
- `j carpeta`: Salta a un directorio frecuente
- Aprende autom√°ticamente de tus `cd`

## Agregar Nuevas Funciones

Para agregar una nueva funci√≥n personalizada, edita `fish.nix`:

```nix
functions = {
  mi-funcion = ''
    # C√≥digo de la funci√≥n aqu√≠
    echo "Hola desde mi funci√≥n"
  '';
};
```

## Agregar Nuevos Aliases

Para agregar un nuevo alias:

```nix
shellAliases = {
  mi-alias = "comando --opciones";
};
```

## Agregar Nuevas Abbreviations

Para agregar una nueva abbreviation:

```nix
shellAbbrs = {
  gs = "git status";
};
```

## Aplicar Cambios

Despu√©s de modificar `fish.nix`:

```bash
make switch
# o
home-manager switch
```

Luego reinicia tu terminal o ejecuta:

```fish
source ~/.config/fish/config.fish
```

## Recursos

- **Documentaci√≥n oficial de Fish**: https://fishshell.com/docs/current/
- **Plugins de Fish**: https://github.com/oh-my-fish/oh-my-fish/blob/master/docs/Plugins.md
- **kaku (inspiraci√≥n)**: https://github.com/linuxmobile/kaku

